#!/usr/bin/env python

import numpy
numpy.seterr(all='raise')

ONLY_N_FILES = 0
ONLY_FILES_CONTAINING = None
#ONLY_FILES_CONTAINING = '01'
ONLY_N_WINDOWS = 0

### writing text
B_DUMP_HARMS = 0
STFT_DUMP_TEXT = 0
STFT_DUMP_ALL = 0

### plotting
B_PLOT = 0
B_PLOT_FIT = 0
B_PLOT_FIT_INDIVIDUAL = 0
B_PRINT_INDIVIDUAL_BS = 0
STFT_PLOT_PARTIALS = 0
STFT_PLOT_FIRST_N = 0
HARMONICS_PRINT_SUMMARY = 0
HARMONICS_PLOT_DECAYS = 0
HARMONICS_PLOT_Q = 0
HARMONICS_PLOT_LOSS = 0
HARMONICS_FIT_PLOT = 0
HARMONICS_FIT_PLOT_N = 0
DECAYS_PLOT_Q = 0
DECAYS_PLOT_DECAYS = 0
DECAYS_PLOT_USED = 0

### control analysis
#B_HIGHER_THAN_SURROUNDING_FACTOR = 2.0
B_MIN_PEAK_EXPLANATORY = 0.5
B_NUM_BUFFERS_ESTIMATE = 1
B_INITIAL_PARTIALS = 5
B_MIN_HARMONIC_FIT_TO = 3
B_MIN_HARMONIC_F0_CONFLICT = 8
B_MINIMUM_HARMONIC_SNR = 10
B_MIN_LOCAL_SNR = 5
B_PEAK_SPREAD_BELOW_HERTZ = 0.1
B_PEAK_SPREAD_ABOVE_HERTZ = 0.2


# stft
#HOPSIZE = 1024
#BUFFER_WINDOWSIZE = 4096
HOPSIZE = 2048
BUFFER_WINDOWSIZE = 8192
LONG_WINDOWSIZE = 16384
#BUFFER_WINDOWSIZE = 4096
#BUFFER_WINDOWSIZE = 2048
ZEROPADDING_FACTOR = 4

TOTAL_HARMONICS = 40
STFT_PEAK_SPREAD_BELOW_HERTZ = 0.05
STFT_PEAK_SPREAD_ABOVE_HERTZ = 0.05
#STFT_PEAK_SPREAD_BELOW_HERTZ = 0.10
#STFT_PEAK_SPREAD_ABOVE_HERTZ = 0.20

STFT_MIN_DB_ABOVE_NOISE = 20

HARMONIC_MAX_DB_ABOVE_NOISE_TOP = 30
HARMONIC_MIN_HOPS_ABOVE_NOISE = 10
HARMONIC_DB_ABOVE_NOISE_TOP = 10
#HARMONIC_MIN_HOPS_ABOVE_NOISE = 10
#HARMONIC_DB_ABOVE_NOISE_TOP = 5

# still trying to pick
#HARMONIC_MIN_DROP_DB = 0.0  # drop to top of noise floor
#HARMONIC_FIT_MIN_RSQUARED = 0.7
HARMONIC_FIT_MIN_RSQUARED = 0.0
HARMONIC_FIT_MAX_VARIANCE = 1.0

MAX_STD_Q_MODE = 1000


NOISE_PERCENTILE_BELOW = 99.0


#long
LONG_LORENTZIAN_RSQUARED_MIN = 0.5
LONG_PEAK_AREA_HERTZ = 50


### overall fitting Q
Q_FIT_MIN_DISTINCT = 3
Q_FIT_START_AT_MODE_MIN = 3
Q_FIT_START_AT_PERCENT = 0.25
Q_FIT_END_AT_LEAST = 0
Q_FIT_END_AT_MOST = 30
Q_FIT_START_AT_MODE_MIN = 1
Q_FIT_START_AT_PERCENT = 0.0


MODES_FIT_TO = 128
#MODES_FIT_TO = 40
MODES_FIXED_EXPONENT = True
#MODES_HACK_LIMIT_WEIGHTS_MAX = 1e2
#MODES_HACK_LIMIT_WEIGHTS_MIN = 1e-2
MODES_HACK_LIMIT_WEIGHTS_MAX = 1.
MODES_HACK_LIMIT_WEIGHTS_MIN = 1.

