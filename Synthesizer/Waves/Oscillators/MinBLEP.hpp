// ripped off from JackSynth by Macho Charli 93
#pragma once

extern double sampleRate;


namespace MinBLEP
{


    #define UNCOPYABLE(T) \
    private: \
    T(const T&) = delete; \
    T& operator=(const T&) = delete;

    typedef uint8_t TUnsigned7; // Value 0..127
    typedef uint8_t TSigned7; // Value -64..63
    typedef float   TFraction; // Value 0..1
    typedef float   TFrequency; // in Hz
    typedef float   TTime; // in ms
    typedef float   TSample;

    using TSampleBuffer = std::vector<TSample>;

    static inline float octaves(float x)
    {
        return x;
    }
    static inline float semitones(float x)
    {
        return x / 12.0f;
    }
    static inline float cents(float x)
    {
        return x / 1200.0f;
    }
    static inline int ms_to_samples(int x)
    {

        return (sampleRate * x) / 1000;
    }
    static inline uint8_t hi7(int v)
    {
        return (v >> 7) & 0x7f;
    }
    static inline uint8_t lo7(int v)
    {
        return v & 0x7f;
    }


    static inline float fpow2(const float y)
    {
        // musicdsp.org, Johannes M.-R.
        union
        {
            float f;
            int i;
        } c;

        int integer = (int) y;
        if (y < 0) integer = integer - 1;

        float frac = y - (float) integer;

        c.i = (integer + 127) << 23;
        c.f *= 0.33977f * frac * frac + (1.0f - 0.33977f) * frac + 1.0f;

        return c.f;
    }

    // Map 0..127 to 1..17696 Hz
    //#define VAL2HZ_HI(n) exp2f(n/9.0f)
    // Map 0..127 to 12..17955 Hz, same scale as Blofeld
    #ifdef __MACH__
    #define VAL2HZ_HI(n) (12*__exp10f(n/40.0f))
    #else
    #define VAL2HZ_HI(n) (12*exp10f(n/40.0f))
    #endif
    // Map 0..127 to 0.19..1261 Hz
    #define VAL2HZ_LO(n) exp2f((n-24)/12.0f)
    // Map 0..127 to 0.35..21247 ms
    #define VAL2MS(n) exp2f((n-12)/8.0f)

    #define NOTE2HZ(note) (exp2f((float(note) - TGlobal::MidiNoteA4) / 12.0) * TGlobal::HzA4)


    /////////////////////////////////////
    // MinBLEP Pulse
    /////////////////////////////////////    
    static const int zeroCrossings = 32;
    static const int  overSampling = 64;
    static const int   tablelength = 4096;
    static const int        length = 64;
    static const float    integral = 61.029026;

    static const float table[tablelength] = {
        -0.0000043362561, -0.0000177444981, -0.0000298275882, -0.0000403009763,
        -0.0000505160424, -0.0000598743791, -0.0000680449521, -0.0000770550760,
        -0.0000848060299, -0.0000910064628, -0.0000963638086, -0.0000999596814,
        -0.0001029964114, -0.0001046696998, -0.0001047591068, -0.0001027431717,
        -0.0000997010502, -0.0000935159551, -0.0000859782958, -0.0000757449234,
        -0.0000642905943, -0.0000487273865, -0.0000307419978, -0.0000098350356,
        0.0000141060809, 0.0000421585792, 0.0000735016729, 0.0001090494334,
        0.0001486031106, 0.0001927746198, 0.0002413231850, 0.0002949833579,
        0.0003547258966, 0.0004192181805, 0.0004894796293, 0.0005658549489,
        0.0006499009905, 0.0007408600650, 0.0008378357161, 0.0009427117184,
        0.0010567231802, 0.0011794298189, 0.0013108197600, 0.0014520747354,
        0.0016026061494, 0.0017641627928, 0.0019368273206, 0.0021213814616,
        0.0023173778318, 0.0025266527664, 0.0027488837950, 0.0029852187727,
        0.0032355666626, 0.0035017924383, 0.0037845303304, 0.0040823980235,
        0.0043981862254, 0.0047316770069, 0.0050861914642, 0.0054586892948,
        0.0058518745936, 0.0062659466639, 0.0067032473162, 0.0071633243933,
        0.0076475515962, 0.0081558153033, 0.0086904717609, 0.0092520294711,
        0.0098418351263, 0.0104605657980, 0.0111083006486, 0.0117876855657,
        0.0124995466322, 0.0132454503328, 0.0140248565003, 0.0148399602622,
        0.0156920179725, 0.0165827758610, 0.0175121333450, 0.0184828788042,
        0.0194949842989, 0.0205509886146, 0.0216504372656, 0.0227966830134,
        0.0239900760353, 0.0252323038876, 0.0265246126801, 0.0278683621436,
        0.0292651783675, 0.0307165142149, 0.0322248302400, 0.0337895974517,
        0.0354133173823, 0.0370976589620, 0.0388447828591, 0.0406561307609,
        0.0425318591297, 0.0444740392268, 0.0464847236872, 0.0485660992563,
        0.0507185757160, 0.0529441572726, 0.0552447922528, 0.0576221607625,
        0.0600776262581, 0.0626128911972, 0.0652286857367, 0.0679274573922,
        0.0707108676434, 0.0735803768039, 0.0765369087458, 0.0795826315880,
        0.0827198028564, 0.0859483033419, 0.0892708227038, 0.0926883369684,
        0.0962039381266, 0.0998167693615, 0.1035292595625, 0.1073423847556,
        0.1112590581179, 0.1152787506580, 0.1194040104747, 0.1236348971725,
        0.1279738098383, 0.1324212849140, 0.1369794458151, 0.1416486054659,
        0.1464292407036, 0.1513226777315, 0.1563313901424, 0.1614554673433,
        0.1666945964098, 0.1720505505800, 0.1775239706039, 0.1831166744232,
        0.1888277381659, 0.1946583688259, 0.2006087303162, 0.2066803127527,
        0.2128715813160, 0.2191850095987, 0.2256190627813, 0.2321752011776,
        0.2388526201248, 0.2456519007683, 0.2525724172592, 0.2596140205860,
        0.2667773663998, 0.2740617394447, 0.2814655303955, 0.2889885008335,
        0.2966320812702, 0.3043944835663, 0.3122736215591, 0.3202694356441,
        0.3283812403679, 0.3366079628468, 0.3449478447437, 0.3534003496170,
        0.3619633913040, 0.3706354796886, 0.3794164061546, 0.3883031606674,
        0.3972939848900, 0.4063868820667, 0.4155803918839, 0.4248731136322,
        0.4342614710331, 0.4437434673309, 0.4533174037933, 0.4629802405834,
        0.4727292954922, 0.4825621843338, 0.4924759864807, 0.5024673938751,
        0.5125339031219, 0.5226721763611, 0.5328793525696, 0.5431512594223,
        0.5534852743149, 0.5638775229454, 0.5743252038956, 0.5848231911659,
        0.5953692197800, 0.6059591770172, 0.6165879368782, 0.6272517442703,
        0.6379477381706, 0.6486712098122, 0.6594175696373, 0.6701819896698,
        0.6809613704681, 0.6917505860329, 0.7025454044342, 0.7133404612541,
        0.7241317033768, 0.7349146008492, 0.7456836700439, 0.7564348578453,
        0.7671634554863, 0.7778638601303, 0.7885312438011, 0.7991611957550,
        0.8097488284111, 0.8202882409096, 0.8307750225067, 0.8412046432495,
        0.8515704870224, 0.8618686199188, 0.8720943331718, 0.8822421431541,
        0.8923058509827, 0.9022818803787, 0.9121648669243, 0.9219500422478,
        0.9316316843033, 0.9412059187889, 0.9506665468216, 0.9600096940994,
        0.9692298769951, 0.9783225655556, 0.9872837662697, 0.9961069226265,
        1.0047892332077, 1.0133255720139, 1.0217115879059, 1.0299426317215,
        1.0380142927170, 1.0459223985672, 1.0536633729935, 1.0612325668335,
        1.0686268806458, 1.0758416652679, 1.0828732252121, 1.0897179841995,
        1.0963733196259, 1.1028345823288, 1.1090997457504, 1.1151647567749,
        1.1210274696350, 1.1266844272614, 1.1321330070496, 1.1373717784882,
        1.1423969268799, 1.1472059488297, 1.1517982482910, 1.1561714410782,
        1.1603238582611, 1.1642528772354, 1.1679584980011, 1.1714388132095,
        1.1746927499771, 1.1777194738388, 1.1805187463760, 1.1830891370773,
        1.1854308843613, 1.1875438690186, 1.1894284486771, 1.1910836696625,
        1.1925103664398, 1.1937099695206, 1.1946829557419, 1.1954296827316,
        1.1959512233734, 1.1962497234344, 1.1963260173798, 1.1961821317673,
        1.1958199739456, 1.1952415704727, 1.1944488286972, 1.1934447288513,
        1.1922309398651, 1.1908119916916, 1.1891894340515, 1.1873666048050,
        1.1853475570679, 1.1831355094910, 1.1807336807251, 1.1781461238861,
        1.1753774881363, 1.1724308729172, 1.1693109273911, 1.1660221815109,
        1.1625697612762, 1.1589574813843, 1.1551909446716, 1.1512748003006,
        1.1472145318985, 1.1430151462555, 1.1386826038361, 1.1342215538025,
        1.1296380758286, 1.1249370574951, 1.1201261281967, 1.1152096986771,
        1.1101942062378, 1.1050856113434, 1.0998905897141, 1.0946145057678,
        1.0892642736435, 1.0838469266891, 1.0783666372299, 1.0728318691254,
        1.0672483444214, 1.0616226196289, 1.0559611320496, 1.0502701997757,
        1.0445566177368, 1.0388274192810, 1.0330879688263, 1.0273452997208,
        1.0216071605682, 1.0158782005310, 1.0101654529572, 1.0044751167297,
        0.9988141655922, 0.9931885004044, 0.9876041412354, 0.9820669293404,
        0.9765843153000, 0.9711609482765, 0.9658034443855, 0.9605169892311,
        0.9553079009056, 0.9501810073853, 0.9451425075531, 0.9401974081993,
        0.9353508949280, 0.9306080937386, 0.9259743690491, 0.9214546680450,
        0.9170519709587, 0.9127724170685, 0.9086198806763, 0.9045989513397,
        0.9007128477097, 0.8969660401344, 0.8933615684509, 0.8899038434029,
        0.8865950703621, 0.8834390640259, 0.8804384469986, 0.8775959014893,
        0.8749139308929, 0.8723949193954, 0.8700411319733, 0.8678539395332,
        0.8658351302147, 0.8639866709709, 0.8623090386391, 0.8608034253120,
        0.8594712018967, 0.8583131432533, 0.8573288321495, 0.8565183877945,
        0.8558823466301, 0.8554208874702, 0.8551321029663, 0.8550165891647,
        0.8550724387169, 0.8552992939949, 0.8556956052780, 0.8562601804733,
        0.8569900393486, 0.8578842878342, 0.8589409589767, 0.8601574897766,
        0.8615311384201, 0.8630586862564, 0.8647384643555, 0.8665668368340,
        0.8685401082039, 0.8706550598145, 0.8729082345963, 0.8752959966660,
        0.8778141736984, 0.8804582953453, 0.8832249641418, 0.8861092329025,
        0.8891069889069, 0.8922135233879, 0.8954237699509, 0.8987323045731,
        0.9021357297897, 0.9056276082993, 0.9092035293579, 0.9128573536873,
        0.9165846109390, 0.9203795194626, 0.9242361783981, 0.9281495809555,
        0.9321137666702, 0.9361242055893, 0.9401735663414, 0.9442563652992,
        0.9483675360680, 0.9525010585785, 0.9566511511803, 0.9608119726181,
        0.9649776220322, 0.9691428542137, 0.9733012318611, 0.9774477481842,
        0.9815764427185, 0.9856814146042, 0.9897572994232, 0.9937993288040,
        0.9978010058403, 1.0017576217651, 1.0056636333466, 1.0095142126083,
        1.0133035182953, 1.0170269012451, 1.0206801891327, 1.0242582559586,
        1.0277560949326, 1.0311697721481, 1.0344941616058, 1.0377255678177,
        1.0408601760864, 1.0438939332962, 1.0468224287033, 1.0496423244476,
        1.0523505210876, 1.0549443960190, 1.0574198961258, 1.0597735643387,
        1.0620039701462, 1.0641075372696, 1.0660833120346, 1.0679274797440,
        1.0696390867233, 1.0712162256241, 1.0726572275162, 1.0739603042603,
        1.0751249790192, 1.0761495828629, 1.0770336389542, 1.0777772665024,
        1.0783795118332, 1.0788397789001, 1.0791587829590, 1.0793364048004,
        1.0793739557266, 1.0792701244354, 1.0790272951126, 1.0786467790604,
        1.0781294107437, 1.0774760246277, 1.0766886472702, 1.0757696628571,
        1.0747197866440, 1.0735427141190, 1.0722402334213, 1.0708144903183,
        1.0692688226700, 1.0676057338715, 1.0658279657364, 1.0639395713806,
        1.0619428157806, 1.0598422288895, 1.0576407909393, 1.0553421974182,
        1.0529507398605, 1.0504703521729, 1.0479048490524, 1.0452591180801,
        1.0425366163254, 1.0397424697876, 1.0368808507919, 1.0339564085007,
        1.0309743881226, 1.0279389619827, 1.0248550176620, 1.0217274427414,
        1.0185606479645, 1.0153604745865, 1.0121310949326, 1.0088781118393,
        1.0056067705154, 1.0023216009140, 0.9990279674530, 0.9957308173180,
        0.9924349188805, 0.9891451597214, 0.9858671426773, 0.9826050996780,
        0.9793649911880, 0.9761504530907, 0.9729665517807, 0.9698183536530,
        0.9667102098465, 0.9636468291283, 0.9606326818466, 0.9576723575592,
        0.9547700881958, 0.9519293904305, 0.9491552114487, 0.9464507102966,
        0.9438204765320, 0.9412676692009, 0.9387964606285, 0.9364095330238,
        0.9341109395027, 0.9319034814835, 0.9297906160355, 0.9277744889259,
        0.9258573651314, 0.9240433573723, 0.9223333001137, 0.9207302927971,
        0.9192357063293, 0.9178519845009, 0.9165803790092, 0.9154227375984,
        0.9143800139427, 0.9134529829025, 0.9126433134079, 0.9119515419006,
        0.9113782048225, 0.9109235405922, 0.9105876088142, 0.9103711247444,
        0.9102729558945, 0.9102931618690, 0.9104304909706, 0.9106853008270,
        0.9110568761826, 0.9115434885025, 0.9121435284615, 0.9128561019897,
        0.9136792421341, 0.9146113395691, 0.9156502485275, 0.9167944192886,
        0.9180412292480, 0.9193876385689, 0.9208319187164, 0.9223714470863,
        0.9240030050278, 0.9257234334946, 0.9275307655334, 0.9294203519821,
        0.9313891530037, 0.9334335327148, 0.9355508685112, 0.9377365708351,
        0.9399871826172, 0.9422984719276, 0.9446673393250, 0.9470885992050,
        0.9495596885681, 0.9520753026009, 0.9546310305595, 0.9572228193283,
        0.9598472118378, 0.9624987840652, 0.9651737213135, 0.9678674936295,
        0.9705758094788, 0.9732943177223, 0.9760180711746, 0.9787430167198,
        0.9814651608467, 0.9841796755791, 0.9868818521500, 0.9895682930946,
        0.9922339916229, 0.9948747754097, 0.9974870681763, 1.0000665187836,
        1.0026084184647, 1.0051091909409, 1.0075652599335, 1.0099729299545,
        1.0123277902603, 1.0146266222000, 1.0168665647507, 1.0190439224243,
        1.0211535692215, 1.0231951475143, 1.0251636505127, 1.0270569324493,
        1.0288717746735, 1.0306060314178, 1.0322571992874, 1.0338227748871,
        1.0353001356125, 1.0366880893707, 1.0379844903946, 1.0391867160797,
        1.0402939319611, 1.0413048267365, 1.0422178506851, 1.0430314540863,
        1.0437453985214, 1.0443588495255, 1.0448710918427, 1.0452812910080,
        1.0455900430679, 1.0457966327667, 1.0459012985229, 1.0459041595459,
        1.0458047389984, 1.0456050634384, 1.0453056097031, 1.0449064970016,
        1.0444098711014, 1.0438158512115, 1.0431264638901, 1.0423432588577,
        1.0414674282074, 1.0405014753342, 1.0394464731216, 1.0383049249649,
        1.0370789766312, 1.0357713699341, 1.0343843698502, 1.0329207181931,
        1.0313826799393, 1.0297735929489, 1.0280959606171, 1.0263531208038,
        1.0245488882065, 1.0226855278015, 1.0207664966583, 1.0187959671021,
        1.0167763233185, 1.0147112607956, 1.0126056671143, 1.0104622840881,
        1.0082844495773, 1.0060764551163, 1.0038417577744, 1.0015851259232,
        0.9993096590042, 0.9970194697380, 0.9947182536125, 0.9924101233482,
        0.9900987148285, 0.9877883195877, 0.9854825139046, 0.9831851720810,
        0.9808999896049, 0.9786310791969, 0.9763820171356, 0.9741566181183,
        0.9719588160515, 0.9697915911674, 0.9676584601402, 0.9655637145042,
        0.9635106325150, 0.9615007638931, 0.9595389366150, 0.9576286673546,
        0.9557718038559, 0.9539717435837, 0.9522319436073, 0.9505545496941,
        0.9489426612854, 0.9473978281021, 0.9459230303764, 0.9445199370384,
        0.9431910514832, 0.9419383406639, 0.9407644271851, 0.9396698474884,
        0.9386566281319, 0.9377266168594, 0.9368801712990, 0.9361192584038,
        0.9354438781738, 0.9348559379578, 0.9343557357788, 0.9339435100555,
        0.9336196184158, 0.9333846569061, 0.9332386255264, 0.9331812858582,
        0.9332125186920, 0.9333318471909, 0.9335392117500, 0.9338335394859,
        0.9342139363289, 0.9346796274185, 0.9352291822433, 0.9358618855476,
        0.9365761280060, 0.9373698830605, 0.9382418394089, 0.9391908645630,
        0.9402145147324, 0.9413108229637, 0.9424772262573, 0.9437122941017,
        0.9450129866600, 0.9463770985603, 0.9478018879890, 0.9492852687836,
        0.9508238434792, 0.9524147510529, 0.9540553092957, 0.9557424187660,
        0.9574729800224, 0.9592445492744, 0.9610533714294, 0.9628959298134,
        0.9647686481476, 0.9666694998741, 0.9685940146446, 0.9705392718315,
        0.9725014567375, 0.9744773507118, 0.9764640927315, 0.9784575104713,
        0.9804539680481, 0.9824501872063, 0.9844429492950, 0.9864289760590,
        0.9884043931961, 0.9903655052185, 0.9923101663589, 0.9942346811295,
        0.9961349964142, 0.9980084896088, 0.9998518228531, 1.0016623735428,
        1.0034366846085, 1.0051717758179, 1.0068651437759, 1.0085136890411,
        1.0101146697998, 1.0116658210754, 1.0131645202637, 1.0146080255508,
        1.0159938335419, 1.0173206329346, 1.0185858011246, 1.0197869539261,
        1.0209231376648, 1.0219916105270, 1.0229921340942, 1.0239217281342,
        1.0247793197632, 1.0255643129349, 1.0262757539749, 1.0269113779068,
        1.0274711847305, 1.0279551744461, 1.0283619165421, 1.0286905765533,
        1.0289418697357, 1.0291144847870, 1.0292088985443, 1.0292257070541,
        1.0291649103165, 1.0290265083313, 1.0288109779358, 1.0285196304321,
        1.0281529426575, 1.0277112722397, 1.0271959304810, 1.0266089439392,
        1.0259507894516, 1.0252226591110, 1.0244264602661, 1.0235639810562,
        1.0226365327835, 1.0216462612152, 1.0205949544907, 1.0194851160049,
        1.0183182954788, 1.0170968770981, 1.0158232450485, 1.0144996643066,
        1.0131293535233, 1.0117143392563, 1.0102573633194, 1.0087606906891,
        1.0072276592255, 1.0056605339050, 1.0040627717972, 1.0024374723434,
        1.0007863044739, 0.9991134405136, 0.9974222183228, 0.9957147836685,
        0.9939941763878, 0.9922634959221, 0.9905266761780, 0.9887863993645,
        0.9870447516441, 0.9853065013885, 0.9835734367371, 0.9818490743637,
        0.9801369905472, 0.9784389138222, 0.9767588376999, 0.9750986695290,
        0.9734625220299, 0.9718529582024, 0.9702717661858, 0.9687225818634,
        0.9672071337700, 0.9657292962074, 0.9642903208733, 0.9628931283951,
        0.9615408182144, 0.9602342247963, 0.9589771628380, 0.9577696323395,
        0.9566153883934, 0.9555155038834, 0.9544718265533, 0.9534858465195,
        0.9525592327118, 0.9516934156418, 0.9508906006813, 0.9501505494118,
        0.9494751691818, 0.9488655328751, 0.9483220577240, 0.9478458166122,
        0.9474372863770, 0.9470968246460, 0.9468250274658, 0.9466223716736,
        0.9464886188507, 0.9464237689972, 0.9464281797409, 0.9465010762215,
        0.9466421604156, 0.9468516111374, 0.9471278786659, 0.9474707245827,
        0.9478793144226, 0.9483526945114, 0.9488896131516, 0.9494891166687,
        0.9501498341560, 0.9508705139160, 0.9516496658325, 0.9524854421616,
        0.9533767104149, 0.9543209671974, 0.9553170204163, 0.9563622474670,
        0.9574546813965, 0.9585928916931, 0.9597741365433, 0.9609964489937,
        0.9622573852539, 0.9635545015335, 0.9648858308792, 0.9662480950356,
        0.9676386713982, 0.9690555930138, 0.9704961776733, 0.9719576239586,
        0.9734373092651, 0.9749321341515, 0.9764397740364, 0.9779574871063,
        0.9794825315475, 0.9810121655464, 0.9825435876846, 0.9840739369392,
        0.9856002926826, 0.9871202111244, 0.9886308908463, 0.9901297092438,
        0.9916141033173, 0.9930810928345, 0.9945282936096, 0.9959532022476,
        0.9973534345627, 0.9987262487411, 1.0000697374344, 1.0013813972473,
        1.0026586055756, 1.0038995742798, 1.0051021575928, 1.0062638521194,
        1.0073833465576, 1.0084583759308, 1.0094876289368, 1.0104683637619,
        1.0114003419876, 1.0122812986374, 1.0131095647812, 1.0138851404190,
        1.0146049261093, 1.0152689218521, 1.0158760547638, 1.0164250135422,
        1.0169149637222, 1.0173454284668, 1.0177161693573, 1.0180265903473,
        1.0182757377625, 1.0184637308121, 1.0185908079147, 1.0186566114426,
        1.0186610221863, 1.0186045169830, 1.0184868574142, 1.0183093547821,
        1.0180720090866, 1.0177755355835, 1.0174208879471, 1.0170080661774,
        1.0165388584137, 1.0160142183304, 1.0154349803925, 1.0148026943207,
        1.0141184329987, 1.0133842229843, 1.0126005411148, 1.0117691755295,
        1.0108921527863, 1.0099712610245, 1.0090079307556, 1.0080049037933,
        1.0069628953934, 1.0058848857880, 1.0047723054886, 1.0036276578903,
        1.0024530887604, 1.0012506246567, 1.0000228881836, 0.9987716078758,
        0.9974999427795, 0.9962100386620, 0.9949040412903, 0.9935847520828,
        0.9922541975975, 0.9909148216248, 0.9895688295364, 0.9882198572159,
        0.9868695139885, 0.9855203032494, 0.9841748476028, 0.9828352928162,
        0.9815043807030, 0.9801848530769, 0.9788782596588, 0.9775871038437,
        0.9763135313988, 0.9750609397888, 0.9738304018974, 0.9726244807243,
        0.9714455604553, 0.9702951908112, 0.9691758155823, 0.9680889248848,
        0.9670363068581, 0.9660204052925, 0.9650428295135, 0.9641048908234,
        0.9632087945938, 0.9623550176620, 0.9615455865860, 0.9607819914818,
        0.9600657224655, 0.9593970775604, 0.9587776660919, 0.9582087993622,
        0.9576904177666, 0.9572240710258, 0.9568101763725, 0.9564492702484,
        0.9561418890953, 0.9558883309364, 0.9556891918182, 0.9555445313454,
        0.9554544091225, 0.9554184079170, 0.9554372429848, 0.9555096030235,
        0.9556361436844, 0.9558163881302, 0.9560495018959, 0.9563350677490,
        0.9566718935966, 0.9570596814156, 0.9574974775314, 0.9579846262932,
        0.9585194587708, 0.9591014981270, 0.9597287774086, 0.9604005813599,
        0.9611152410507, 0.9618718028069, 0.9626680016518, 0.9635030627251,
        0.9643746018410, 0.9652807116508, 0.9662207365036, 0.9671916961670,
        0.9681931138039, 0.9692212343216, 0.9702752232552, 0.9713530540466,
        0.9724522829056, 0.9735708236694, 0.9747067093849, 0.9758580923080,
        0.9770227670670, 0.9781983494759, 0.9793825149536, 0.9805725812912,
        0.9817669987679, 0.9829635024071, 0.9841601848602, 0.9853542447090,
        0.9865438938141, 0.9877271056175, 0.9889009594917, 0.9900638461113,
        0.9912136793137, 0.9923481345177, 0.9934654235840, 0.9945636987686,
        0.9956406950951, 0.9966947436333, 0.9977234601974, 0.9987252950668,
        0.9996985197067, 1.0006417036057, 1.0015532970428, 1.0024313926697,
        1.0032740831375, 1.0040800571442, 1.0048487186432, 1.0055778026581,
        1.0062668323517, 1.0069143772125, 1.0075196027756, 1.0080811977386,
        1.0085984468460, 1.0090698003769, 1.0094952583313, 1.0098743438721,
        1.0102063417435, 1.0104912519455, 1.0107281208038, 1.0109169483185,
        1.0110566616058, 1.0111477375031, 1.0111900568008, 1.0111844539642,
        1.0111302137375, 1.0110282897949, 1.0108785629272, 1.0106812715530,
        1.0104373693466, 1.0101469755173, 1.0098106861115, 1.0094294548035,
        1.0090048313141, 1.0085378885269, 1.0080288648605, 1.0074789524078,
        1.0068892240524, 1.0062601566315, 1.0055941343307, 1.0048922300339,
        1.0041559934616, 1.0033864974976, 1.0025858879089, 1.0017552375793,
        1.0008964538574, 1.0000108480453, 0.9991004467010, 0.9981664419174,
        0.9972119331360, 0.9962379336357, 0.9952461123466, 0.9942383170128,
        0.9932168126106, 0.9921835064888, 0.9911403656006, 0.9900896549225,
        0.9890329837799, 0.9879719018936, 0.9869093298912, 0.9858465790749,
        0.9847854375839, 0.9837288260460, 0.9826778769493, 0.9816344380379,
        0.9806007146835, 0.9795787930489, 0.9785698056221, 0.9775767326355,
        0.9766005873680, 0.9756432175636, 0.9747065901756, 0.9737918376923,
        0.9729002714157, 0.9720349907875, 0.9711965918541, 0.9703866243362,
        0.9696067571640, 0.9688575267792, 0.9681410193443, 0.9674581289291,
        0.9668098092079, 0.9661976099014, 0.9656222462654, 0.9650850296021,
        0.9645863175392, 0.9641276001930, 0.9637088179588, 0.9633318781853,
        0.9629956483841, 0.9627014994621, 0.9624498486519, 0.9622409343719,
        0.9620753526688, 0.9619531035423, 0.9618734717369, 0.9618375301361,
        0.9618448615074, 0.9618948101997, 0.9619874954224, 0.9621227979660,
        0.9623001813889, 0.9625187516212, 0.9627795815468, 0.9630807638168,
        0.9634214639664, 0.9638010859489, 0.9642187952995, 0.9646732807159,
        0.9651644825935, 0.9656911492348, 0.9662520289421, 0.9668458104134,
        0.9674711227417, 0.9681273698807, 0.9688132405281, 0.9695261120796,
        0.9702652096748, 0.9710298776627, 0.9718179702759, 0.9726278185844,
        0.9734577536583, 0.9743066430092, 0.9751724600792, 0.9760535359383,
        0.9769484400749, 0.9778554439545, 0.9787719845772, 0.9796975255013,
        0.9806300401688, 0.9815669059753, 0.9825071692467, 0.9834485650063,
        0.9843900203705, 0.9853296279907, 0.9862648844719, 0.9871940612793,
        0.9881166219711, 0.9890300631523, 0.9899325370789, 0.9908237457275,
        0.9916998744011, 0.9925607442856, 0.9934041500092, 0.9942293167114,
        0.9950338006020, 0.9958177804947, 0.9965785145760, 0.9973145127296,
        0.9980247616768, 0.9987083077431, 0.9993638396263, 0.9999895691872,
        1.0005854368210, 1.0011498928070, 1.0016820430756, 1.0021814107895,
        1.0026468038559, 1.0030771493912, 1.0034719705582, 1.0038307905197,
        1.0041532516479, 1.0044384002686, 1.0046859979630, 1.0048955678940,
        1.0050677061081, 1.0052011013031, 1.0052961111069, 1.0053526163101,
        1.0053701400757, 1.0053491592407, 1.0052905082703, 1.0051937103271,
        1.0050587654114, 1.0048869848251, 1.0046781301498, 1.0044327974319,
        1.0041517019272, 1.0038356781006, 1.0034844875336, 1.0030996799469,
        1.0026823282242, 1.0022333860397, 1.0017534494400, 1.0012435913086,
        1.0007038116455, 1.0001362562180, 0.9995427727699, 0.9989235997200,
        0.9982801079750, 0.9976138472557, 0.9969250559807, 0.9962165951729,
        0.9954894185066, 0.9947447776794, 0.9939836859703, 0.9932084679604,
        0.9924197196960, 0.9916198849678, 0.9908093214035, 0.9899916052818,
        0.9891660809517, 0.9883355498314, 0.9875014424324, 0.9866648912430,
        0.9858274459839, 0.9849909543991, 0.9841572046280, 0.9833276867867,
        0.9825043082237, 0.9816879034042, 0.9808797240257, 0.9800819754601,
        0.9792955517769, 0.9785223603249, 0.9777640700340, 0.9770209193230,
        0.9762946367264, 0.9755880832672, 0.9749009013176, 0.9742347002029,
        0.9735904932022, 0.9729688763618, 0.9723727107048, 0.9718014597893,
        0.9712570905685, 0.9707396626472, 0.9702507257462, 0.9697905778885,
        0.9693601727486, 0.9689604043961, 0.9685923457146, 0.9682552218437,
        0.9679503440857, 0.9676780700684, 0.9674394726753, 0.9672341942787,
        0.9670628309250, 0.9669250845909, 0.9668206572533, 0.9667511582375,
        0.9667157530785, 0.9667143821716, 0.9667470455170, 0.9668135046959,
        0.9669138789177, 0.9670465588570, 0.9672128558159, 0.9674112200737,
        0.9676416516304, 0.9679034352303, 0.9681962728500, 0.9685193300247,
        0.9688712358475, 0.9692522883415, 0.9696612358093, 0.9700972437859,
        0.9705588221550, 0.9710457921028, 0.9715568423271, 0.9720908403397,
        0.9726468324661, 0.9732234477997, 0.9738201498985, 0.9744349718094,
        0.9750667214394, 0.9757146239281, 0.9763775467873, 0.9770539999008,
        0.9777421951294, 0.9784411191940, 0.9791489243507, 0.9798651933670,
        0.9805880188942, 0.9813160300255, 0.9820477962494, 0.9827820062637,
        0.9835171103477, 0.9842517375946, 0.9849846959114, 0.9857143759727,
        0.9864396452904, 0.9871586561203, 0.9878705143929, 0.9885737299919,
        0.9892672300339, 0.9899497628212, 0.9906196594238, 0.9912762641907,
        0.9919181466103, 0.9925434589386, 0.9931521415710, 0.9937421083450,
        0.9943130016327, 0.9948635101318, 0.9953926801682, 0.9958996772766,
        0.9963841438293, 0.9968445301056, 0.9972795844078, 0.9976893663406,
        0.9980729818344, 0.9984298348427, 0.9987589120865, 0.9990620017052,
        0.9993355274200, 0.9995800852776, 0.9997949600220, 0.9999805688858,
        1.0001363754272, 1.0002626180649, 1.0003596544266, 1.0004258155823,
        1.0004619359970, 1.0004668235779, 1.0004425048828, 1.0003880262375,
        1.0003041028976, 1.0001910924911, 1.0000488758087, 0.9998778104782,
        0.9996784329414, 0.9994507431984, 0.9991961717606, 0.9989150762558,
        0.9986079335213, 0.9982751607895, 0.9979174733162, 0.9975358843803,
        0.9971310496330, 0.9967032670975, 0.9962546229362, 0.9957849383354,
        0.9952958822250, 0.9947882890701, 0.9942629933357, 0.9937216043472,
        0.9931647181511, 0.9925934076309, 0.9920086860657, 0.9914124011993,
        0.9908056259155, 0.9901891350746, 0.9895640611649, 0.9889325499535,
        0.9882944226265, 0.9876518249512, 0.9870055913925, 0.9863577485085,
        0.9857083559036, 0.9850596189499, 0.9844122529030, 0.9837673902512,
        0.9831268787384, 0.9824906587601, 0.9818613529205, 0.9812396168709,
        0.9806267023087, 0.9800233244896, 0.9794306755066, 0.9788501858711,
        0.9782822132111, 0.9777287840843, 0.9771899580956, 0.9766680002213,
        0.9761629104614, 0.9756751656532, 0.9752072691917, 0.9747579097748,
        0.9743293523788, 0.9739215373993, 0.9735364913940, 0.9731732010841,
        0.9728333353996, 0.9725172519684, 0.9722250103951, 0.9719574451447,
        0.9717151522636, 0.9714981913567, 0.9713068604469, 0.9711413383484,
        0.9710026979446, 0.9708902835846, 0.9708051681519, 0.9707460999489,
        0.9707135558128, 0.9707075357437, 0.9707272052765, 0.9707742929459,
        0.9708474278450, 0.9709466099739, 0.9710714817047, 0.9712216854095,
        0.9713968634605, 0.9715969562531, 0.9718210101128, 0.9720689654350,
        0.9723399281502, 0.9726333022118, 0.9729489088058, 0.9732850193977,
        0.9736416935921, 0.9740180969238, 0.9744130373001, 0.9748272299767,
        0.9752579331398, 0.9757052659988, 0.9761681556702, 0.9766451716423,
        0.9771358966827, 0.9776389598846, 0.9781537652016, 0.9786787033081,
        0.9792141318321, 0.9797576665878, 0.9803081750870, 0.9808648824692,
        0.9814275503159, 0.9819936156273, 0.9825633764267, 0.9831354022026,
        0.9837082028389, 0.9842800498009, 0.9848506450653, 0.9854192137718,
        0.9859839081764, 0.9865442514420, 0.9870995879173, 0.9876477122307,
        0.9881882667542, 0.9887207150459, 0.9892430305481, 0.9897544384003,
        0.9902544617653, 0.9907426238060, 0.9912165403366, 0.9916766285896,
        0.9921227693558, 0.9925525188446, 0.9929654002190, 0.9933608174324,
        0.9937382936478, 0.9940966367722, 0.9944365620613, 0.9947565793991,
        0.9950560927391, 0.9953346848488, 0.9955919981003, 0.9958268404007,
        0.9960400462151, 0.9962317943573, 0.9964002966881, 0.9965452551842,
        0.9966674447060, 0.9967665672302, 0.9968414902687, 0.9968934655190,
        0.9969218373299, 0.9969264864922, 0.9969077110291, 0.9968661665916,
        0.9968015551567, 0.9967141747475, 0.9966038465500, 0.9964711070061,
        0.9963160753250, 0.9961398839951, 0.9959419369698, 0.9957234263420,
        0.9954854249954, 0.9952270388603, 0.9949494004250, 0.9946535825729,
        0.9943399429321, 0.9940078854561, 0.9936596751213, 0.9932962656021,
        0.9929177165031, 0.9925244450569, 0.9921178221703, 0.9916983842850,
        0.9912669658661, 0.9908249378204, 0.9903724789619, 0.9899109005928,
        0.9894412159920, 0.9889634847641, 0.9884800314903, 0.9879913330078,
        0.9874976873398, 0.9870004057884, 0.9865006804466, 0.9859993457794,
        0.9854972958565, 0.9849959015846, 0.9844952821732, 0.9839971661568,
        0.9835012555122, 0.9830095767975, 0.9825236201286, 0.9820433855057,
        0.9815694689751, 0.9811034798622, 0.9806460142136, 0.9801979660988,
        0.9797598719597, 0.9793329834938, 0.9789178967476, 0.9785146713257,
        0.9781253337860, 0.9777497649193, 0.9773887991905, 0.9770426154137,
        0.9767131805420, 0.9763991236687, 0.9761028885841, 0.9758239984512,
        0.9755623936653, 0.9753195643425, 0.9750951528549, 0.9748897552490,
        0.9747040867805, 0.9745382070541, 0.9743925333023, 0.9742663502693,
        0.9741607308388, 0.9740757942200, 0.9740111231804, 0.9739665389061,
        0.9739424586296, 0.9739395380020, 0.9739564061165, 0.9739944338799,
        0.9740523695946, 0.9741299748421, 0.9742279052734, 0.9743444323540,
        0.9744805097580, 0.9746350646019, 0.9748086333275, 0.9750002026558,
        0.9752093553543, 0.9754357337952, 0.9756784439087, 0.9759374260902,
        0.9762122631073, 0.9765022397041, 0.9768060445786, 0.9771239161491,
        0.9774547219276, 0.9777984023094, 0.9781535267830, 0.9785196185112,
        0.9788959026337, 0.9792817234993, 0.9796761870384, 0.9800786972046,
        0.9804880619049, 0.9809033870697, 0.9813245534897, 0.9817505478859,
        0.9821802973747, 0.9826132059097, 0.9830483794212, 0.9834846854210,
        0.9839215278625, 0.9843578338623, 0.9847930669785, 0.9852262139320,
        0.9856562018394, 0.9860829114914, 0.9865049123764, 0.9869216084480,
        0.9873324632645, 0.9877368211746, 0.9881334304810, 0.9885221123695,
        0.9889019727707, 0.9892716407776, 0.9896312355995, 0.9899798631668,
        0.9903172254562, 0.9906416535378, 0.9909533858299, 0.9912517070770,
        0.9915364384651, 0.9918076395988, 0.9920635819435, 0.9923053979874,
        0.9925306439400, 0.9927399158478, 0.9929325580597, 0.9931085109711,
        0.9932689070702, 0.9934111833572, 0.9935370087624, 0.9936446547508,
        0.9937351346016, 0.9938082098961, 0.9938631653786, 0.9939007759094,
        0.9939202070236, 0.9939224123955, 0.9939065575600, 0.9938738346100,
        0.9938228130341, 0.9937546253204, 0.9936703443527, 0.9935685992241,
        0.9934508204460, 0.9933156967163, 0.9931662082672, 0.9930004477501,
        0.9928200244904, 0.9926249980927, 0.9924154281616, 0.9921928048134,
        0.9919560551643, 0.9917070865631, 0.9914451837540, 0.9911720752716,
        0.9908877015114, 0.9905929565430, 0.9902886748314, 0.9899742007256,
        0.9896528124809, 0.9893218278885, 0.9889845848083, 0.9886406064034,
        0.9882904291153, 0.9879359006882, 0.9875754117966, 0.9872128367424,
        0.9868462681770, 0.9864787459373, 0.9861085414886, 0.9857378602028,
        0.9853673577309, 0.9849967360497, 0.9846281409264, 0.9842602014542,
        0.9838965535164, 0.9835354089737, 0.9831789135933, 0.9828271269798,
        0.9824811816216, 0.9821414947510, 0.9818071722984, 0.9814822673798,
        0.9811629056931, 0.9808540344238, 0.9805536866188, 0.9802632927895,
        0.9799833297729, 0.9797126650810, 0.9794547557831, 0.9792063832283,
        0.9789724946022, 0.9787503480911, 0.9785416722298, 0.9783455133438,
        0.9781623482704, 0.9779944419861, 0.9778376817703, 0.9776980280876,
        0.9775717854500, 0.9774618744850, 0.9773662686348, 0.9772847294807,
        0.9772192239761, 0.9771671295166, 0.9771327376366, 0.9771119952202,
        0.9771081805229, 0.9771174788475, 0.9771430492401, 0.9771837592125,
        0.9772383570671, 0.9773083925247, 0.9773921966553, 0.9774913787842,
        0.9776034355164, 0.9777307510376, 0.9778701066971, 0.9780235290527,
        0.9781889319420, 0.9783665537834, 0.9785575270653, 0.9787586927414,
        0.9789717793465, 0.9791948795319, 0.9794293045998, 0.9796718955040,
        0.9799240231514, 0.9801850914955, 0.9804541468620, 0.9807311892509,
        0.9810147285461, 0.9813057780266, 0.9816008210182, 0.9819020032883,
        0.9822076559067, 0.9825170636177, 0.9828313589096, 0.9831475615501,
        0.9834665060043, 0.9837856292725, 0.9841064810753, 0.9844270348549,
        0.9847472310066, 0.9850663542747, 0.9853842854500, 0.9857001304626,
        0.9860128164291, 0.9863222837448, 0.9866272807121, 0.9869285821915,
        0.9872232079506, 0.9875140190125, 0.9877970814705, 0.9880741834641,
        0.9883433580399, 0.9886053204536, 0.9888585805893, 0.9891028404236,
        0.9893389344215, 0.9895641803741, 0.9897806644440, 0.9899858832359,
        0.9901815652847, 0.9903651475906, 0.9905377626419, 0.9906988739967,
        0.9908468127251, 0.9909840226173, 0.9911087155342, 0.9912213087082,
        0.9913206100464, 0.9914069175720, 0.9914798140526, 0.9915392994881,
        0.9915865063667, 0.9916205406189, 0.9916416406631, 0.9916488528252,
        0.9916433691978, 0.9916239976883, 0.9915919899940, 0.9915478229523,
        0.9914900660515, 0.9914203286171, 0.9913378357887, 0.9912434816360,
        0.9911361336708, 0.9910182356834, 0.9908882975578, 0.9907472729683,
        0.9905962944031, 0.9904340505600, 0.9902625679970, 0.9900799393654,
        0.9898892641068, 0.9896878600121, 0.9894788265228, 0.9892626404762,
        0.9890387058258, 0.9888075590134, 0.9885690212250, 0.9883243441582,
        0.9880735278130, 0.9878176450729, 0.9875572323799, 0.9872929453850,
        0.9870247840881, 0.9867536425591, 0.9864798784256, 0.9862037301064,
        0.9859259128571, 0.9856477379799, 0.9853688478470, 0.9850902557373,
        0.9848127365112, 0.9845350980759, 0.9842600822449, 0.9839870333672,
        0.9837165474892, 0.9834501147270, 0.9831868410110, 0.9829284548759,
        0.9826740622520, 0.9824252724648, 0.9821819663048, 0.9819449186325,
        0.9817138910294, 0.9814901351929, 0.9812746047974, 0.9810661673546,
        0.9808664917946, 0.9806740283966, 0.9804905056953, 0.9803162813187,
        0.9801523089409, 0.9799979925156, 0.9798531532288, 0.9797183275223,
        0.9795935750008, 0.9794794917107, 0.9793758392334, 0.9792847037315,
        0.9792038798332, 0.9791345596313, 0.9790759086609, 0.9790279865265,
        0.9789920449257, 0.9789667725563, 0.9789537787437, 0.9789515733719,
        0.9789616465569, 0.9789817929268, 0.9790129661560, 0.9790549278259,
        0.9791080355644, 0.9791730046272, 0.9792473912239, 0.9793329834938,
        0.9794286489487, 0.9795335531235, 0.9796476960182, 0.9797719120979,
        0.9799055457115, 0.9800478816032, 0.9801991581917, 0.9803578257561,
        0.9805241823196, 0.9806977510452, 0.9808785319328, 0.9810671210289,
        0.9812616109848, 0.9814620018005, 0.9816679358482, 0.9818785786629,
        0.9820932149887, 0.9823127388954, 0.9825364947319, 0.9827636480331,
        0.9829927682877, 0.9832248091698, 0.9834582805634, 0.9836941361427,
        0.9839304685593, 0.9841676354408, 0.9844048023224, 0.9846410751343,
        0.9848772883415, 0.9851120114326, 0.9853453636169, 0.9855760931969,
        0.9858044981956, 0.9860297441483, 0.9862521290779, 0.9864706993103,
        0.9866843223572, 0.9868935942650, 0.9870979189873, 0.9872971773148,
        0.9874897599220, 0.9876773953438, 0.9878579974174, 0.9880320429802,
        0.9881992340088, 0.9883592724800, 0.9885113239288, 0.9886550903320,
        0.9887912869453, 0.9889184832573, 0.9890376329422, 0.9891484379768,
        0.9892493486404, 0.9893419742584, 0.9894251227379, 0.9894996285439,
        0.9895641803741, 0.9896194338799, 0.9896653890610, 0.9897004365921,
        0.9897272586823, 0.9897443056107, 0.9897516965866, 0.9897487163544,
        0.9897377490997, 0.9897161126137, 0.9896856546402, 0.9896463751793,
        0.9895972609520, 0.9895396828651, 0.9894726872444, 0.9893975853920,
        0.9893137812614, 0.9892222881317, 0.9891231060028, 0.9890154600143,
        0.9889000058174, 0.9887784123421, 0.9886493086815, 0.9885134100914,
        0.9883713722229, 0.9882228374481, 0.9880685806274, 0.9879087209702,
        0.9877440333366, 0.9875743389130, 0.9874010086060, 0.9872229695320,
        0.9870414137840, 0.9868566393852, 0.9866690039635, 0.9864792823792,
        0.9862868785858, 0.9860934615135, 0.9858976006508, 0.9857013821602,
        0.9855040311813, 0.9853065013885, 0.9851094484329, 0.9849134087563,
        0.9847182631493, 0.9845234751701, 0.9843311905861, 0.9841408133507,
        0.9839525818825, 0.9837675690651, 0.9835853576660, 0.9834072589874,
        0.9832327365875, 0.9830622076988, 0.9828957915306, 0.9827343821526,
        0.9825779199600, 0.9824270606041, 0.9822815060616, 0.9821419119835,
        0.9820078611374, 0.9818802475929, 0.9817593693733, 0.9816456437111,
        0.9815382957458, 0.9814383387566, 0.9813457131386, 0.9812603592873,
        0.9811828732491, 0.9811124205589, 0.9810500144958, 0.9809954762459,
        0.9809489846230, 0.9809104204178, 0.9808791875839, 0.9808562397957,
        0.9808412194252, 0.9808349013329, 0.9808365106583, 0.9808458685875,
        0.9808634519577, 0.9808882474899, 0.9809209108353, 0.9809606075287,
        0.9810083508492, 0.9810630679131, 0.9811258316040, 0.9811950325966,
        0.9812710881233, 0.9813537001610, 0.9814428687096, 0.9815390110016,
        0.9816406369209, 0.9817487001419, 0.9818619489670, 0.9819806218147,
        0.9821041226387, 0.9822326898575, 0.9823653697968, 0.9825029373169,
        0.9826449155807, 0.9827902913094, 0.9829387068748, 0.9830896854401,
        0.9832446575165, 0.9834007620811, 0.9835594892502, 0.9837204813957,
        0.9838831424713, 0.9840469956398, 0.9842112660408, 0.9843764901161,
        0.9845409989357, 0.9847058057785, 0.9848700761795, 0.9850341677666,
        0.9851968288422, 0.9853578209877, 0.9855173826218, 0.9856741428375,
        0.9858293533325, 0.9859812259674, 0.9861306548119, 0.9862774014473,
        0.9864199161530, 0.9865595698357, 0.9866941571236, 0.9868254661560,
        0.9869510531425, 0.9870731830597, 0.9871904253960, 0.9873020052910,
        0.9874095320702, 0.9875105619431, 0.9876064658165, 0.9876958727837,
        0.9877796173096, 0.9878570437431, 0.9879294633865, 0.9879952669144,
        0.9880545139313, 0.9881075620651, 0.9881535172462, 0.9881924986839,
        0.9882249236107, 0.9882516264915, 0.9882718324661, 0.9882854819298,
        0.9882920980453, 0.9882918000221, 0.9882845282555, 0.9882714152336,
        0.9882514476776, 0.9882255792618, 0.9881930351257, 0.9881543517113,
        0.9881096482277, 0.9880590438843, 0.9880032539368, 0.9879411458969,
        0.9878736734390, 0.9878004193306, 0.9877216219902, 0.9876384139061,
        0.9875503778458, 0.9874582886696, 0.9873616099358, 0.9872609972954,
        0.9871560931206, 0.9870466589928, 0.9869347810745, 0.9868198633194,
        0.9867018461227, 0.9865812063217, 0.9864588975906, 0.9863333702087,
        0.9862056374550, 0.9860764145851, 0.9859465956688, 0.9858155846596,
        0.9856839776039, 0.9855522513390, 0.9854201674461, 0.9852880239487,
        0.9851564764977, 0.9850254654884, 0.9848953485489, 0.9847667813301,
        0.9846397638321, 0.9845145940781, 0.9843918085098, 0.9842705726624,
        0.9841522574425, 0.9840367436409, 0.9839249849319, 0.9838154315948,
        0.9837099909782, 0.9836091399193, 0.9835116267204, 0.9834181070328,
        0.9833292961121, 0.9832448363304, 0.9831654429436, 0.9830909371376,
        0.9830223917961, 0.9829586744308, 0.9829003810883, 0.9828478693962,
        0.9828007221222, 0.9827601909637, 0.9827253818512, 0.9826977252960,
        0.9826752543449, 0.9826599359512, 0.9826499819756, 0.9826472401619,
        0.9826511144638, 0.9826619029045, 0.9826788306236, 0.9827026724815,
        0.9827332496643, 0.9827703833580, 0.9828144907951, 0.9828655719757,
        0.9829229712486, 0.9829865694046, 0.9830575585365, 0.9831348061562,
        0.9832185506821, 0.9833087921143, 0.9834055304527, 0.9835082292557,
        0.9836172461510, 0.9837330579758, 0.9838542342186, 0.9839814305305,
        0.9841149449348, 0.9842534661293, 0.9843972325325, 0.9845459461212,
        0.9847006201744, 0.9848600625992, 0.9850247502327, 0.9851943254471,
        0.9853676557541, 0.9855459928513, 0.9857277274132, 0.9859141707420,
        0.9861042499542, 0.9862985014915, 0.9864965081215, 0.9866968989372,
        0.9869011044502, 0.9871073961258, 0.9873167276382, 0.9875283241272,
        0.9877427816391, 0.9879591464996, 0.9881771802902, 0.9883979558945,
        0.9886199235916, 0.9888429641724, 0.9890676736832, 0.9892932772636,
        0.9895193576813, 0.9897463321686, 0.9899737834930, 0.9902018308640,
        0.9904301166534, 0.9906585216522, 0.9908866286278, 0.9911140799522,
        0.9913418292999, 0.9915692806244, 0.9917957782745, 0.9920213222504,
        0.9922463893890, 0.9924693703651, 0.9926913380623, 0.9929128885269,
        0.9931322932243, 0.9933509826660, 0.9935677647591, 0.9937828779221,
        0.9939959645271, 0.9942076802254, 0.9944179654121, 0.9946259856224,
        0.9948325157166, 0.9950369596481, 0.9952387213707, 0.9954383969307,
        0.9956364631653, 0.9958319067955, 0.9960254430771, 0.9962171912193,
        0.9964060187340, 0.9965931177139, 0.9967777729034, 0.9969601035118,
        0.9971399903297, 0.9973182678223, 0.9974941611290, 0.9976673126221,
        0.9978388547897, 0.9980081915855, 0.9981752038002, 0.9983399510384,
        0.9985028505325, 0.9986639618874, 0.9988228082657, 0.9989799261093,
        0.9991346597672, 0.9992878437042, 0.9994391798973, 0.9995883107185,
        0.9997358918190, 0.9998818039894, 1.0000257492065, 1.0001682043076,
        1.0003093481064, 1.0004485845566, 1.0005862712860, 1.0007225275040,
        1.0008567571640, 1.0009901523590, 1.0011221170425, 1.0012526512146,
        1.0013815164566, 1.0015091896057, 1.0016356706619, 1.0017608404160,
        1.0018843412399, 1.0020067691803, 1.0021280050278, 1.0022474527359,
        1.0023659467697, 1.0024833679199, 1.0025993585587, 1.0027136802673,
        1.0028266906738, 1.0029388666153, 1.0030494928360, 1.0031585693359,
        1.0032663345337, 1.0033724308014, 1.0034766197205, 1.0035794973373,
        1.0036808252335, 1.0037806034088, 1.0038785934448, 1.0039747953415,
        1.0040688514709, 1.0041612386703, 1.0042515993118, 1.0043399333954,
        1.0044261217117, 1.0045105218887, 1.0045920610428, 1.0046710968018,
        1.0047475099564, 1.0048217773438, 1.0048933029175, 1.0049618482590,
        1.0050278902054, 1.0050909519196, 1.0051504373550, 1.0052065849304,
        1.0052602291107, 1.0053106546402, 1.0053567886353, 1.0053992271423,
        1.0054388046265, 1.0054742097855, 1.0055052042007, 1.0055330991745,
        1.0055570602417, 1.0055764913559, 1.0055909156799, 1.0056020021439,
        1.0056087970734, 1.0056103467941, 1.0056078433990, 1.0056008100510,
        1.0055894851685, 1.0055721998215, 1.0055502653122, 1.0055239200592,
        1.0054923295975, 1.0054554939270, 1.0054140090942, 1.0053682327271,
        1.0053172111511, 1.0052602291107, 1.0051982402802, 1.0051310062408,
        1.0050591230392, 1.0049816370010, 1.0048995018005, 1.0048124790192,
        1.0047199726105, 1.0046225786209, 1.0045198202133, 1.0044126510620,
        1.0043004751205, 1.0041825771332, 1.0040608644485, 1.0039341449738,
        1.0038030147552, 1.0036673545837, 1.0035276412964, 1.0033833980560,
        1.0032348632812, 1.0030828714371, 1.0029271841049, 1.0027676820755,
        1.0026042461395, 1.0024375915527, 1.0022683143616, 1.0020952224731,
        1.0019193887711, 1.0017412900925, 1.0015604496002, 1.0013769865036,
        1.0011917352676, 1.0010050535202, 1.0008167028427, 1.0006270408630,
        1.0004360675812, 1.0002440214157, 1.0000510215759, 0.9998576045036,
        0.9996646046638, 0.9994716048241, 0.9992787837982, 0.9990863204002,
        0.9988944530487, 0.9987038969994, 0.9985145330429, 0.9983271360397,
        0.9981409907341, 0.9979566335678, 0.9977748394012, 0.9975955486298,
        0.9974198937416, 0.9972467422485, 0.9970773458481, 0.9969107508659,
        0.9967480897903, 0.9965894818306, 0.9964354634285, 0.9962862133980,
        0.9961413741112, 0.9960016012192, 0.9958665966988, 0.9957371950150,
        0.9956133365631, 0.9954954385757, 0.9953839182854, 0.9952782392502,
        0.9951787590981, 0.9950858950615, 0.9949994683266, 0.9949201345444,
        0.9948482513428, 0.9947828650475, 0.9947248101234, 0.9946738481522,
        0.9946304559708, 0.9945949316025, 0.9945666193962, 0.9945463538170,
        0.9945332407951, 0.9945282936096, 0.9945311546326, 0.9945411682129,
        0.9945589303970, 0.9945847988129, 0.9946182966232, 0.9946588873863,
        0.9947081804276, 0.9947649240494, 0.9948292374611, 0.9949011206627,
        0.9949808716774, 0.9950677156448, 0.9951611757278, 0.9952619671822,
        0.9953702688217, 0.9954848885536, 0.9956063032150, 0.9957340955734,
        0.9958688020706, 0.9960097074509, 0.9961564540863, 0.9963093400002,
        0.9964671730995, 0.9966307282448, 0.9967994093895, 0.9969725608826,
        0.9971504807472, 0.9973326921463, 0.9975191950798, 0.9977096319199,
        0.9979035854340, 0.9981006383896, 0.9983008503914, 0.9985041022301,
        0.9987088441849, 0.9989150762558, 0.9991232752800, 0.9993337392807,
        0.9995445609093, 0.9997562170029, 0.9999688267708, 1.0001811981201,
        1.0003929138184, 1.0006046295166, 1.0008151531219, 1.0010246038437,
        1.0012322664261, 1.0014390945435, 1.0016430616379, 1.0018446445465,
        1.0020437240601, 1.0022393465042, 1.0024318695068, 1.0026205778122,
        1.0028055906296, 1.0029857158661, 1.0031615495682, 1.0033322572708,
        1.0034981966019, 1.0036588907242, 1.0038136243820, 1.0039622783661,
        1.0041049718857, 1.0042414665222, 1.0043715238571, 1.0044945478439,
        1.0046107769012, 1.0047204494476, 1.0048217773438, 1.0049164295197,
        1.0050036907196, 1.0050832033157, 1.0051543712616, 1.0052179098129,
        1.0052732229233, 1.0053195953369, 1.0053585767746, 1.0053899288177,
        1.0054124593735, 1.0054267644882, 1.0054324865341, 1.0054302215576,
        1.0054183006287, 1.0053991079330, 1.0053719282150, 1.0053365230560,
        1.0052927732468, 1.0052405595779, 1.0051808357239, 1.0051124095917,
        1.0050367116928, 1.0049533843994, 1.0048627853394, 1.0047647953033,
        1.0046589374542, 1.0045459270477, 1.0044262409210, 1.0042998790741,
        1.0041668415070, 1.0040276050568, 1.0038826465607, 1.0037318468094,
        1.0035756826401, 1.0034142732620, 1.0032476186752, 1.0030755996704,
        1.0029000043869, 1.0027197599411, 1.0025362968445, 1.0023485422134,
        1.0021586418152, 1.0019650459290, 1.0017681121826, 1.0015698671341,
        1.0013689994812, 1.0011671781540, 1.0009634494781, 1.0007592439651,
        1.0005540847778, 1.0003478527069, 1.0001424551010, 0.9999371767044,
        0.9997327327728, 0.9995294809341, 0.9993274807930, 0.9991270899773,
        0.9989282488823, 0.9987319707870, 0.9985388517380, 0.9983481764793,
        0.9981608390808, 0.9979771375656, 0.9977973103523, 0.9976216554642,
        0.9974499940872, 0.9972836971283, 0.9971219301224, 0.9969658255577,
        0.9968146085739, 0.9966697096825, 0.9965304732323, 0.9963974356651,
        0.9962708950043, 0.9961504340172, 0.9960374236107, 0.9959307909012,
        0.9958314299583, 0.9957392811775, 0.9956550002098, 0.9955778717995,
        0.9955082535744, 0.9954466223717, 0.9953925609589, 0.9953469038010,
        0.9953089952469, 0.9952794313431, 0.9952576756477, 0.9952437281609,
        0.9952381253242, 0.9952404499054, 0.9952511191368, 0.9952692985535,
        0.9952954649925, 0.9953296780586, 0.9953718781471, 0.9954212903976,
        0.9954791069031, 0.9955440759659, 0.9956158995628, 0.9956956505775,
        0.9957823753357, 0.9958764314651, 0.9959767460823, 0.9960843324661,
        0.9961977601051, 0.9963173866272, 0.9964428544044, 0.9965744018555,
        0.9967118501663, 0.9968546628952, 0.9970024824142, 0.9971547126770,
        0.9973111748695, 0.9974718689919, 0.9976367354393, 0.9978054761887,
        0.9979779720306, 0.9981530308723, 0.9983309507370, 0.9985107779503,
        0.9986931085587, 0.9988775253296, 0.9990636706352, 0.9992507696152,
        0.9994388222694, 0.9996275305748, 0.9998162984848, 1.0000052452087,
        1.0001935958862, 1.0003814697266, 1.0005682706833, 1.0007536411285,
        1.0009378194809, 1.0011194944382, 1.0012990236282, 1.0014764070511,
        1.0016503334045, 1.0018211603165, 1.0019890069962, 1.0021531581879,
        1.0023130178452, 1.0024688243866, 1.0026197433472, 1.0027662515640,
        1.0029073953629, 1.0030438899994, 1.0031747817993, 1.0032997131348,
        1.0034190416336, 1.0035321712494, 1.0036395788193, 1.0037405490875,
        1.0038353204727, 1.0039230585098, 1.0040038824081, 1.0040780305862,
        1.0041452646255, 1.0042058229446, 1.0042581558228, 1.0043034553528,
        1.0043423175812, 1.0043733119965, 1.0043965578079, 1.0044122934341,
        1.0044218301773, 1.0044224262238, 1.0044162273407, 1.0044020414352,
        1.0043809413910, 1.0043529272079, 1.0043165683746, 1.0042741298676,
        1.0042238235474, 1.0041664838791, 1.0041038990021, 1.0040340423584,
        1.0039570331573, 1.0038726329803, 1.0037839412689, 1.0036886930466,
        1.0035876035690, 1.0034791231155, 1.0033652782440, 1.0032461881638,
        1.0031234025955, 1.0029942989349, 1.0028605461121, 1.0027220249176,
        1.0025820732117, 1.0024379491806, 1.0022889375687, 1.0021361112595,
        1.0019813776016, 1.0018246173859, 1.0016633272171, 1.0014992952347,
        1.0013334751129, 1.0011671781540, 1.0010004043579, 1.0008310079575,
        1.0006598234177, 1.0004901885986, 1.0003211498260, 1.0001510381699,
        0.9999804496765, 0.9998109340668, 0.9996434450150, 0.9994776248932,
        0.9993117451668, 0.9991470575333, 0.9989857077599, 0.9988267421722,
        0.9986714124680, 0.9985176324844, 0.9983665347099, 0.9982191920280,
        0.9980767369270, 0.9979376196861, 0.9978020787239, 0.9976711869240,
        0.9975453615189, 0.9974251389503, 0.9973083138466, 0.9971961379051,
        0.9970908761024, 0.9969906210899, 0.9968969225883, 0.9968076348305,
        0.9967248439789, 0.9966483712196, 0.9965778589249, 0.9965138435364,
        0.9964556694031, 0.9964050650597, 0.9963600635529, 0.9963228702545,
        0.9962916970253, 0.9962666630745, 0.9962487816811, 0.9962375164032,
        0.9962331652641, 0.9962356090546, 0.9962441325188, 0.9962607622147,
        0.9962832331657, 0.9963120818138, 0.9963474869728, 0.9963899254799,
        0.9964377880096, 0.9964922070503, 0.9965525269508, 0.9966183304787,
        0.9966902136803, 0.9967682361603, 0.9968522191048, 0.9969419240952,
        0.9970359802246, 0.9971358180046, 0.9972402453423, 0.9973497390747,
        0.9974623322487, 0.9975795149803, 0.9977008700371, 0.9978257417679,
        0.9979550838470, 0.9980862736702, 0.9982206225395, 0.9983593821526,
        0.9985010027885, 0.9986444115639, 0.9987895488739, 0.9989370107651,
        0.9990857839584, 0.9992354512215, 0.9993853569031, 0.9995367527008,
        0.9996897578239, 0.9998414516449, 0.9999938607216, 1.0001455545425,
        1.0002961158752, 1.0004472732544, 1.0005979537964, 1.0007458925247,
        1.0008920431137, 1.0010365247726, 1.0011783838272, 1.0013177394867,
        1.0014542341232, 1.0015881061554, 1.0017201900482, 1.0018485784531,
        1.0019733905792, 1.0020937919617, 1.0022100210190, 1.0023229122162,
        1.0024322271347, 1.0025355815887, 1.0026344060898, 1.0027284622192,
        1.0028176307678, 1.0029013156891, 1.0029798746109, 1.0030531883240,
        1.0031219720840, 1.0031855106354, 1.0032432079315, 1.0032943487167,
        1.0033397674561, 1.0033789873123, 1.0034127235413, 1.0034400224686,
        1.0034606456757, 1.0034757852554, 1.0034854412079, 1.0034898519516,
        1.0034869909286, 1.0034774541855, 1.0034625530243, 1.0034428834915,
        1.0034157037735, 1.0033829212189, 1.0033451318741, 1.0033010244370,
        1.0032522678375, 1.0031974315643, 1.0031361579895, 1.0030692815781,
        1.0029994249344, 1.0029249191284, 1.0028448104858, 1.0027593374252,
        1.0026696920395, 1.0025777816772, 1.0024799108505, 1.0023769140244,
        1.0022711753845, 1.0021615028381, 1.0020498037338, 1.0019350051880,
        1.0018154382706, 1.0016925334930, 1.0015699863434, 1.0014438629150,
        1.0013160705566, 1.0011858940125, 1.0010540485382, 1.0009223222733,
        1.0007894039154, 1.0006537437439, 1.0005180835724, 1.0003831386566,
        1.0002480745316, 1.0001132488251, 0.9999767541885, 0.9998409152031,
        0.9997088313103, 0.9995760917664, 0.9994448423386, 0.9993149042130,
        0.9991864562035, 0.9990613460541, 0.9989383816719, 0.9988163709641,
        0.9986975193024, 0.9985824823380, 0.9984704852104, 0.9983611702919,
        0.9982554316521, 0.9981518983841, 0.9980545639992, 0.9979600310326,
        0.9978697299957, 0.9977840185165, 0.9977020621300, 0.9976254701614,
        0.9975535869598, 0.9974854588509, 0.9974229335785, 0.9973656535149,
        0.9973125457764, 0.9972651004791, 0.9972239136696, 0.9971863031387,
        0.9971548318863, 0.9971294403076, 0.9971083402634, 0.9970932006836,
        0.9970825314522, 0.9970785379410, 0.9970796704292, 0.9970846772194,
        0.9970959424973, 0.9971128702164, 0.9971344470978, 0.9971615672112,
        0.9971951842308, 0.9972322583199, 0.9972743988037, 0.9973229765892,
        0.9973749518394, 0.9974318146706, 0.9974940419197, 0.9975602626801,
        0.9976319074631, 0.9977062940598, 0.9977848529816, 0.9978678822517,
        0.9979546666145, 0.9980448484421, 0.9981386661530, 0.9982352256775,
        0.9983338117599, 0.9984373450279, 0.9985421299934, 0.9986492395401,
        0.9987594485283, 0.9988719224930, 0.9989866614342, 0.9991023540497,
        0.9992167949677, 0.9993355274200, 0.9994553327560, 0.9995756149292,
        0.9996960759163, 0.9998170137405, 0.9999375939369, 1.0000591278076,
        1.0001795291901, 1.0002982616425, 1.0004180669785, 1.0005371570587,
        1.0006552934647, 1.0007715225220, 1.0008833408356, 1.0009948015213,
        1.0011062622070, 1.0012142658234, 1.0013204813004, 1.0014244318008,
        1.0015248060226, 1.0016235113144, 1.0017176866531, 1.0018088817596,
        1.0018973350525, 1.0019823312759, 1.0020632743835, 1.0021405220032,
        1.0022110939026, 1.0022798776627, 1.0023461580276, 1.0024062395096,
        1.0024626255035, 1.0025144815445, 1.0025615692139, 1.0026051998138,
        1.0026437044144, 1.0026756525040, 1.0027041435242, 1.0027282238007,
        1.0027469396591, 1.0027608871460, 1.0027681589127, 1.0027718544006,
        1.0027710199356, 1.0027650594711, 1.0027545690536, 1.0027393102646,
        1.0027201175690, 1.0026962757111, 1.0026669502258, 1.0026327371597,
        1.0025943517685, 1.0025517940521, 1.0025050640106, 1.0024546384811,
        1.0023970603943, 1.0023376941681, 1.0022746324539, 1.0022076368332,
        1.0021367073059, 1.0020620822906, 1.0019856691360, 1.0019055604935,
        1.0018224716187, 1.0017358064651, 1.0016462802887, 1.0015543699265,
        1.0014605522156, 1.0013648271561, 1.0012652873993, 1.0011647939682,
        1.0010637044907, 1.0009607076645, 1.0008562803268, 1.0007503032684,
        1.0006443262100, 1.0005375146866, 1.0004303455353, 1.0003222227097,
        1.0002143383026, 1.0001074075699, 1.0000002384186, 0.9998930096626,
        0.9997855424881, 0.9996803402901, 0.9995765089989, 0.9994743466377,
        0.9993719458580, 0.9992716908455, 0.9991730451584, 0.9990777373314,
        0.9989844560623, 0.9988921284676, 0.9988033771515, 0.9987171888351,
        0.9986339211464, 0.9985527992249, 0.9984753727913, 0.9984014034271,
        0.9983309507370, 0.9982636570930, 0.9981992840767, 0.9981393814087,
        0.9980818629265, 0.9980297684669, 0.9979813694954, 0.9979355335236,
        0.9978948235512, 0.9978588223457, 0.9978268146515, 0.9977986812592,
        0.9977750182152, 0.9977555274963, 0.9977409243584, 0.9977306723595,
        0.9977243542671, 0.9977229833603, 0.9977245330811, 0.9977315068245,
        0.9977427124977, 0.9977567791939, 0.9977757930756, 0.9978005886078,
        0.9978291392326, 0.9978622794151, 0.9978990554810, 0.9979383945465,
        0.9979822039604, 0.9980300664902, 0.9980810880661, 0.9981358051300,
        0.9981945753098, 0.9982569813728, 0.9983226060867, 0.9983884096146,
        0.9984583258629, 0.9985321760178, 0.9986094236374, 0.9986897110939,
        0.9987719058990, 0.9988543987274, 0.9989399909973, 0.9990274310112,
        0.9991160631180, 0.9992065429688, 0.9992988705635, 0.9993923306465,
        0.9994869232178, 0.9995797872543, 0.9996744990349, 0.9997701048851,
        0.9998666644096, 0.9999639987946, 1.0000603199005, 1.0001565217972,
        1.0002524852753, 1.0003488063812, 1.0004431009293, 1.0005359649658,
        1.0006291866302, 1.0007209777832, 1.0008113384247, 1.0008983612061,
        1.0009849071503, 1.0010697841644, 1.0011531114578, 1.0012329816818,
        1.0013109445572, 1.0013858079910, 1.0014595985413, 1.0015305280685,
        1.0015977621078, 1.0016623735428, 1.0017254352570, 1.0017843246460,
        1.0018392801285, 1.0018898248672, 1.0019378662109, 1.0019826889038,
        1.0020240545273, 1.0020619630814, 1.0020965337753, 1.0021263360977,
        1.0021525621414, 1.0021753311157, 1.0021939277649, 1.0022084712982,
        1.0022207498550, 1.0022277832031, 1.0022308826447, 1.0022286176682,
        1.0022227764130, 1.0022134780884, 1.0021998882294, 1.0021829605103,
        1.0021624565125, 1.0021378993988, 1.0021097660065, 1.0020780563354,
        1.0020430088043, 1.0020040273666, 1.0019619464874, 1.0019158124924,
        1.0018675327301, 1.0018149614334, 1.0017606019974, 1.0017035007477,
        1.0016438961029, 1.0015815496445, 1.0015158653259, 1.0014481544495,
        1.0013781785965, 1.0013062953949, 1.0012313127518, 1.0011551380157,
        1.0010758638382, 1.0009967088699, 1.0009166002274, 1.0008336305618,
        1.0007493495941, 1.0006653070450, 1.0005805492401, 1.0004948377609,
        1.0004081726074, 1.0003212690353, 1.0002342462540, 1.0001471042633,
        1.0000599622726, 0.9999735951424, 0.9998861551285, 0.9998013973236,
        0.9997172951698, 0.9996336698532, 0.9995513558388, 0.9994708299637,
        0.9993911981583, 0.9993131160736, 0.9992361068726, 0.9991617202759,
        0.9990894794464, 0.9990197420120, 0.9989508390427, 0.9988852739334,
        0.9988200664520, 0.9987587928772, 0.9987006187439, 0.9986453652382,
        0.9985928535461, 0.9985433816910, 0.9984971284866, 0.9984540343285,
        0.9984136819839, 0.9983763694763, 0.9983420372009, 0.9983120560646,
        0.9982842206955, 0.9982612133026, 0.9982402920723, 0.9982242584229,
        0.9982114434242, 0.9982015490532, 0.9981960654259, 0.9981938004494,
        0.9981952905655, 0.9982006549835, 0.9982088208199, 0.9982200264931,
        0.9982352256775, 0.9982538223267, 0.9982752799988, 0.9983010292053,
        0.9983298778534, 0.9983614683151, 0.9983962178230, 0.9984353184700,
        0.9984767436981, 0.9985207915306, 0.9985681176186, 0.9986180663109,
        0.9986701607704, 0.9987240433693, 0.9987816214561, 0.9988412857056,
        0.9989030361176, 0.9989668130875, 0.9990339279175, 0.9991016983986,
        0.9991712570190, 0.9992431998253, 0.9993154406548, 0.9993880987167,
        0.9994624853134, 0.9995383620262, 0.9996151328087, 0.9996915459633,
        0.9997700452805, 0.9998481869698, 0.9999259710312, 1.0000039339066,
        1.0000833272934, 1.0001612901688, 1.0002392530441, 1.0003172159195,
        1.0003932714462, 1.0004684925079, 1.0005434751511, 1.0006171464920,
        1.0006903409958, 1.0007612705231, 1.0008313655853, 1.0008999109268,
        1.0009669065475, 1.0010311603546, 1.0010951757431, 1.0011558532715,
        1.0012152194977, 1.0012716054916, 1.0013250112534, 1.0013768672943,
        1.0014258623123, 1.0014725923538, 1.0015172958374, 1.0015577077866,
        1.0015953779221, 1.0016311407089, 1.0016635656357, 1.0016930103302,
        1.0017191171646, 1.0017423629761, 1.0017626285553, 1.0017795562744,
        1.0017933845520, 1.0018042325974, 1.0018116235733, 1.0018151998520,
        1.0018166303635, 1.0018154382706, 1.0018100738525, 1.0018012523651,
        1.0017895698547, 1.0017746686935, 1.0017549991608, 1.0017338991165,
        1.0017095804214, 1.0016834735870, 1.0016535520554, 1.0016216039658,
        1.0015857219696, 1.0015472173691, 1.0015072822571, 1.0014646053314,
        1.0014195442200, 1.0013709068298, 1.0013207197189, 1.0012685060501,
        1.0012127161026, 1.0011564493179, 1.0010981559753, 1.0010398626328,
        1.0009782314301, 1.0009162425995, 1.0008518695831, 1.0007864236832,
        1.0007200241089, 1.0006529092789, 1.0005857944489, 1.0005158185959,
        1.0004467964172, 1.0003769397736, 1.0003060102463, 1.0002346038818,
        1.0001642704010, 1.0000954866409, 1.0000252723694, 0.9999567270279,
        0.9998868703842, 0.9998185038567, 0.9997509121895, 0.9996851086617,
        0.9996191859245, 0.9995537996292, 0.9994906783104, 0.9994281530380,
        0.9993676543236, 0.9993075132370, 0.9992507696152, 0.9991943836212,
        0.9991406202316, 0.9990891218185, 0.9990388751030, 0.9989926218987,
        0.9989469647408, 0.9989045858383, 0.9988629817963, 0.9988250136375,
        0.9987894296646, 0.9987564682961, 0.9987282752991, 0.9987001419067,
        0.9986763000488, 0.9986530542374, 0.9986345767975, 0.9986177682877,
        0.9986035227776, 0.9985942244530, 0.9985860586166, 0.9985817670822,
        0.9985781311989, 0.9985796213150, 0.9985822439194, 0.9985893368721,
        0.9986008405685, 0.9986124038696, 0.9986281991005, 0.9986454248428,
        0.9986668825150, 0.9986894726753, 0.9987159967422, 0.9987445473671,
        0.9987754821777, 0.9988092184067, 0.9988436102867, 0.9988816380501,
        0.9989211559296, 0.9989639520645, 0.9990094900131, 0.9990554451942,
        0.9991033077240, 0.9991530776024, 0.9992047548294, 0.9992566108704,
        0.9993107914925, 0.9993667006493, 0.9994239211082, 0.9994814991951,
        0.9995406866074, 0.9995999336243, 0.9996601343155, 0.9997217655182,
        0.9997840523720, 0.9998470544815, 0.9999085068703, 0.9999715685844,
        1.0000334978104, 1.0000960826874, 1.0001593828201, 1.0002225637436,
        1.0002852678299, 1.0003458261490, 1.0004068613052, 1.0004662275314,
        1.0005260705948, 1.0005841255188, 1.0006407499313, 1.0006961822510,
        1.0007507801056, 1.0008041858673, 1.0008550882339, 1.0009056329727,
        1.0009535551071, 1.0010005235672, 1.0010457038879, 1.0010886192322,
        1.0011293888092, 1.0011678934097, 1.0012054443359, 1.0012397766113,
        1.0012711286545, 1.0013006925583, 1.0013279914856, 1.0013533830643,
        1.0013767480850, 1.0013972520828, 1.0014145374298, 1.0014302730560,
        1.0014427900314, 1.0014536380768, 1.0014601945877, 1.0014650821686,
        1.0014675855637, 1.0014671087265, 1.0014632940292, 1.0014574527740,
        1.0014495849609, 1.0014396905899, 1.0014278888702, 1.0014119148254,
        1.0013936758041, 1.0013724565506, 1.0013495683670, 1.0013254880905,
        1.0012974739075, 1.0012682676315, 1.0012369155884, 1.0012047290802,
        1.0011692047119, 1.0011315345764, 1.0010926723480, 1.0010522603989,
        1.0010097026825, 1.0009651184082, 1.0009187459946, 1.0008701086044,
        1.0008215904236, 1.0007730722427, 1.0007225275040, 1.0006706714630,
        1.0006185770035, 1.0005661249161, 1.0005125999451, 1.0004576444626,
        1.0004028081894, 1.0003471374512, 1.0002912282944, 1.0002347230911,
        1.0001789331436, 1.0001219511032, 1.0000666379929, 1.0000118017197,
        0.9999567866325, 0.9999012351036, 0.9998466968536, 0.9997932910919,
        0.9997419118881, 0.9996893405914, 0.9996395707130, 0.9995899200439,
        0.9995409846306, 0.9994927048683, 0.9994456171989, 0.9994006752968,
        0.9993570446968, 0.9993151426315, 0.9992742538452, 0.9992356896400,
        0.9991986155510, 0.9991643428802, 0.9991334080696, 0.9991022348404,
        0.9990747570992, 0.9990471005440, 0.9990223646164, 0.9989992380142,
        0.9989777207375, 0.9989587664604, 0.9989431500435, 0.9989296197891,
        0.9989183545113, 0.9989089369774, 0.9989014267921, 0.9988974332809,
        0.9988955259323, 0.9988954067230, 0.9988991022110, 0.9989044070244,
        0.9989114403725, 0.9989201426506, 0.9989316463470, 0.9989448189735,
        0.9989610314369, 0.9989783167839, 0.9989991188049, 0.9990202784538,
        0.9990438222885, 0.9990710616112, 0.9990993142128, 0.9991295933723,
        0.9991622567177, 0.9991952180862, 0.9992297887802, 0.9992669224739,
        0.9993047714233, 0.9993436336517, 0.9993845224380, 0.9994260668755,
        0.9994691610336, 0.9995127916336, 0.9995584487915, 0.9996050000191,
        0.9996511936188, 0.9996985197067, 0.9997479319572, 0.9997964501381,
        0.9998458027840, 0.9998959302902, 0.9999454021454, 0.9999955892563,
        1.0000455379486, 1.0000964403152, 1.0001460313797, 1.0001951456070,
        1.0002443790436, 1.0002924203873, 1.0003397464752, 1.0003871917725,
        1.0004347562790, 1.0004806518555, 1.0005260705948, 1.0005706548691,
        1.0006133317947, 1.0006551742554, 1.0006963014603, 1.0007375478745,
        1.0007754564285, 1.0008125305176, 1.0008481740952, 1.0008811950684,
        1.0009130239487, 1.0009434223175, 1.0009720325470, 1.0009982585907,
        1.0010240077972, 1.0010476112366, 1.0010683536530, 1.0010877847672,
        1.0011062622070, 1.0011230707169, 1.0011371374130, 1.0011490583420,
        1.0011587142944, 1.0011664628983, 1.0011721849442, 1.0011761188507,
        1.0011770725250, 1.0011767148972, 1.0011742115021, 1.0011694431305,
        1.0011619329453, 1.0011527538300, 1.0011423826218, 1.0011307001114,
        1.0011165142059, 1.0011007785797, 1.0010819435120, 1.0010616779327,
        1.0010412931442, 1.0010170936584, 1.0009906291962, 1.0009633302689,
        1.0009354352951, 1.0009047985077, 1.0008730888367, 1.0008398294449,
        1.0008056163788, 1.0007703304291, 1.0007333755493, 1.0006968975067,
        1.0006570816040, 1.0006172657013, 1.0005780458450, 1.0005369186401,
        1.0004940032959, 1.0004508495331, 1.0004081726074, 1.0003645420074,
        1.0003196001053, 1.0002748966217, 1.0002297163010, 1.0001857280731,
        1.0001407861710, 1.0000978708267, 1.0000531673431, 1.0000094175339,
        0.9999668598175, 0.9999231100082, 0.9998796582222, 0.9998368024826,
        0.9997953772545, 0.9997543692589, 0.9997138381004, 0.9996740818024,
        0.9996357560158, 0.9995976090431, 0.9995614886284, 0.9995274543762,
        0.9994935393333, 0.9994608163834, 0.9994293451309, 0.9993993043900,
        0.9993699789047, 0.9993432164192, 0.9993180036545, 0.9992948174477,
        0.9992720484734, 0.9992505908012, 0.9992317557335, 0.9992141127586,
        0.9991982579231, 0.9991855025291, 0.9991729259491, 0.9991622567177,
        0.9991531968117, 0.9991464018822, 0.9991412162781, 0.9991382956505,
        0.9991376399994, 0.9991387128830, 0.9991409182549, 0.9991443753242,
        0.9991503953934, 0.9991587996483, 0.9991693496704, 0.9991815090179,
        0.9991935491562, 0.9992080926895, 0.9992235302925, 0.9992412924767,
        0.9992601871490, 0.9992805719376, 0.9993027448654, 0.9993258714676,
        0.9993509650230, 0.9993768334389, 0.9994041919708, 0.9994335770607,
        0.9994645118713, 0.9994961023331, 0.9995274543762, 0.9995607733727,
        0.9995943307877, 0.9996298551559, 0.9996647834778, 0.9997007250786,
        0.9997375011444, 0.9997749924660, 0.9998136758804, 0.9998518228531,
        0.9998905658722, 0.9999303817749, 0.9999693632126, 1.0000085830688,
        1.0000468492508, 1.0000859498978, 1.0001249313354, 1.0001645088196,
        1.0002020597458, 1.0002397298813, 1.0002772808075, 1.0003144741058,
        1.0003505945206, 1.0003855228424, 1.0004202127457, 1.0004550218582,
        1.0004880428314, 1.0005201101303, 1.0005513429642, 1.0005807876587,
        1.0006107091904, 1.0006395578384, 1.0006660223007, 1.0006911754608,
        1.0007148981094, 1.0007382631302, 1.0007600784302, 1.0007802248001,
        1.0007989406586, 1.0008169412613, 1.0008330345154, 1.0008474588394,
        1.0008594989777, 1.0008697509766, 1.0008805990219, 1.0008881092072,
        1.0008947849274, 1.0008994340897, 1.0009030103683, 1.0009033679962,
        1.0009044408798, 1.0009028911591, 1.0008982419968, 1.0008941888809,
        1.0008884668350, 1.0008803606033, 1.0008702278137, 1.0008593797684,
        1.0008474588394, 1.0008326768875, 1.0008178949356, 1.0008006095886,
        1.0007830858231, 1.0007634162903, 1.0007437467575, 1.0007209777832,
        1.0006965398788, 1.0006728172302, 1.0006479024887, 1.0006211996078,
        1.0005937814713, 1.0005661249161, 1.0005379915237, 1.0005078315735,
        1.0004771947861, 1.0004456043243, 1.0004148483276, 1.0003836154938,
        1.0003523826599, 1.0003196001053, 1.0002851486206, 1.0002512931824,
        1.0002173185349, 1.0001829862595, 1.0001490116119, 1.0001151561737,
        1.0000804662704, 1.0000458955765, 1.0000118017197, 0.9999778270721,
        0.9999451041222, 0.9999126195908, 0.9998810887337, 0.9998496770859,
        0.9998183846474, 0.9997875690460, 0.9997578859329, 0.9997279644012,
        0.9996995925903, 0.9996718764305, 0.9996446371078, 0.9996191859245,
        0.9995948672295, 0.9995707869530, 0.9995487928391, 0.9995266199112,
        0.9995059370995, 0.9994865059853, 0.9994683861732, 0.9994521737099,
        0.9994375705719, 0.9994229078293, 0.9994099140167, 0.9993987083435,
        0.9993873834610, 0.9993793368340, 0.9993724822998, 0.9993665814400,
        0.9993625879288, 0.9993597865105, 0.9993584156036, 0.9993578195572,
        0.9993594884872, 0.9993620514870, 0.9993678331375, 0.9993735551834,
        0.9993795752525, 0.9993879199028, 0.9993970990181, 0.9994075894356,
        0.9994204640388, 0.9994345307350, 0.9994489550591, 0.9994657635689,
        0.9994822740555, 0.9994994997978, 0.9995188117027, 0.9995389580727,
        0.9995614886284, 0.9995843172073, 0.9996067285538, 0.9996304512024,
        0.9996554851532, 0.9996809959412, 0.9997071623802, 0.9997333884239,
        0.9997602105141, 0.9997891783714, 0.9998179674149, 0.9998458623886,
        0.9998745918274, 0.9999045133591, 0.9999338984489, 0.9999645948410,
        0.9999943971634, 1.0000238418579, 1.0000549554825, 1.0000853538513,
        1.0001147985458, 1.0001446008682, 1.0001738071442, 1.0002038478851,
        1.0002343654633, 1.0002627372742, 1.0002894401550, 1.0003174543381,
        1.0003445148468, 1.0003713369370, 1.0003972053528, 1.0004211664200,
        1.0004465579987, 1.0004701614380, 1.0004923343658, 1.0005134344101,
        1.0005341768265, 1.0005542039871, 1.0005735158920, 1.0005917549133,
        1.0006077289581, 1.0006235837936, 1.0006390810013, 1.0006527900696,
        1.0006649494171, 1.0006755590439, 1.0006853342056, 1.0006939172745,
        1.0007011890411, 1.0007066726685, 1.0007116794586, 1.0007152557373,
        1.0007179975510, 1.0007183551788, 1.0007188320160, 1.0007172822952,
        1.0007147789001, 1.0007114410400, 1.0007061958313, 1.0007005929947,
        1.0006928443909, 1.0006839036942, 1.0006742477417, 1.0006635189056,
        1.0006518363953, 1.0006393194199, 1.0006256103516, 1.0006102323532,
        1.0005944967270, 1.0005769729614, 1.0005583763123, 1.0005400180817,
        1.0005204677582, 1.0004996061325, 1.0004777908325, 1.0004557371140,
        1.0004330873489, 1.0004096031189, 1.0003854036331, 1.0003609657288,
        1.0003366470337, 1.0003113746643, 1.0002853870392, 1.0002593994141,
        1.0002325773239, 1.0002062320709, 1.0001789331436, 1.0001523494720,
        1.0001248121262, 1.0000975131989, 1.0000705718994, 1.0000432729721,
        1.0000163316727, 0.9999908208847, 0.9999650716782, 0.9999400377274,
        0.9999147653580, 0.9998889565468, 0.9998642802238, 0.9998406171799,
        0.9998171329498, 0.9997937083244, 0.9997712969780, 0.9997490048409,
        0.9997285008430, 0.9997069835663, 0.9996874332428, 0.9996690154076,
        0.9996509552002, 0.9996339678764, 0.9996178150177, 0.9996016025543,
        0.9995871782303, 0.9995744824409, 0.9995622038841, 0.9995509386063,
        0.9995412230492, 0.9995319843292, 0.9995237588882, 0.9995161890984,
        0.9995093941689, 0.9995047450066, 0.9995008707047, 0.9994983077049,
        0.9994964003563, 0.9994950294495, 0.9994958639145, 0.9994970560074,
        0.9994996786118, 0.9995021224022, 0.9995080232620, 0.9995140433311,
        0.9995208978653, 0.9995282292366, 0.9995361566544, 0.9995457530022,
        0.9995555877686, 0.9995675086975, 0.9995793104172, 0.9995920062065,
        0.9996060729027, 0.9996201395988, 0.9996352195740, 0.9996508359909,
        0.9996680617332, 0.9996864795685, 0.9997048377991, 0.9997231364250,
        0.9997414946556, 0.9997613430023, 0.9997822046280, 0.9998026490211,
        0.9998235106468, 0.9998450279236, 0.9998658299446, 0.9998874068260,
        0.9999096989632, 0.9999313354492, 0.9999530315399, 0.9999758005142,
        0.9999979138374, 1.0000203847885, 1.0000426769257, 1.0000641345978,
        1.0000861883163, 1.0001075267792, 1.0001286268234, 1.0001506805420,
        1.0001705884933, 1.0001914501190, 1.0002110004425, 1.0002297163010,
        1.0002474784851, 1.0002669095993, 1.0002850294113, 1.0003020763397,
        1.0003188848495, 1.0003341436386, 1.0003497600555, 1.0003638267517,
        1.0003775358200, 1.0003916025162, 1.0004028081894, 1.0004148483276,
        1.0004256963730, 1.0004358291626, 1.0004438161850, 1.0004525184631,
        1.0004599094391, 1.0004661083221, 1.0004715919495, 1.0004756450653,
        1.0004800558090, 1.0004835128784, 1.0004853010178, 1.0004863739014,
        1.0004848241806, 1.0004837512970, 1.0004819631577, 1.0004789829254,
        1.0004757642746, 1.0004715919495, 1.0004665851593, 1.0004603862762,
        1.0004533529282, 1.0004448890686, 1.0004363059998, 1.0004276037216,
        1.0004172325134, 1.0004055500031, 1.0003919601440, 1.0003796815872,
        1.0003672838211, 1.0003534555435, 1.0003402233124, 1.0003250837326,
        1.0003099441528, 1.0002936124802, 1.0002774000168, 1.0002611875534,
        1.0002437829971, 1.0002267360687, 1.0002088546753, 1.0001890659332,
        1.0001691579819, 1.0001507997513, 1.0001324415207, 1.0001131296158,
        1.0000944137573, 1.0000749826431, 1.0000556707382, 1.0000362396240,
        1.0000164508820, 0.9999979138374, 0.9999787807465, 0.9999593496323,
        0.9999411702156, 0.9999206662178, 0.9999011158943, 0.9998835921288,
        0.9998658299446, 0.9998481869698, 0.9998309016228, 0.9998142719269,
        0.9997985363007, 0.9997828006744, 0.9997665286064, 0.9997517466545,
        0.9997373819351, 0.9997236728668, 0.9997111558914, 0.9996986389160,
        0.9996864795685, 0.9996753931046, 0.9996643662453, 0.9996542334557,
        0.9996443986893, 0.9996365904808, 0.9996297359467, 0.9996238946915,
        0.9996174573898, 0.9996112585068, 0.9996070265770, 0.9996036291122,
        0.9996011257172, 0.9995998144150, 0.9995985627174, 0.9995983839035,
        0.9995985627174, 0.9995993971825, 0.9996005892754, 0.9996030926704,
        0.9996075630188, 0.9996123909950, 0.9996167421341, 0.9996208548546,
        0.9996266961098, 0.9996336698532, 0.9996404051781, 0.9996494650841,
        0.9996590018272, 0.9996692538261, 0.9996796846390, 0.9996894001961,
        0.9997007250786, 0.9997118115425, 0.9997243881226, 0.9997375011444,
        0.9997506141663, 0.9997628331184, 0.9997764825821, 0.9997911453247,
        0.9998046755791, 0.9998204112053, 0.9998351335526, 0.9998500943184,
        0.9998656511307, 0.9998808503151, 0.9998949766159, 0.9999104142189,
        0.9999257326126, 0.9999415874481, 0.9999571442604, 0.9999707341194,
        0.9999860525131, 1.0000010728836, 1.0000162124634, 1.0000321865082,
        1.0000470876694, 1.0000617504120, 1.0000764131546, 1.0000911951065,
        1.0001055002213, 1.0001192092896, 1.0001326799393, 1.0001447200775,
        1.0001571178436, 1.0001667737961, 1.0001778602600, 1.0001890659332,
        1.0001994371414, 1.0002088546753, 1.0002182722092, 1.0002274513245,
        1.0002357959747, 1.0002431869507, 1.0002503395081, 1.0002562999725,
        1.0002620220184, 1.0002670288086, 1.0002717971802, 1.0002740621567,
        1.0002772808075, 1.0002800226212, 1.0002816915512, 1.0002809762955,
        1.0002812147141, 1.0002813339233, 1.0002809762955, 1.0002794265747,
        1.0002772808075, 1.0002737045288, 1.0002697706223, 1.0002659559250,
        1.0002614259720, 1.0002543926239, 1.0002484321594, 1.0002421140671,
        1.0002354383469, 1.0002259016037, 1.0002177953720, 1.0002093315125,
        1.0002007484436, 1.0001910924911, 1.0001811981201, 1.0001708269119,
        1.0001597404480, 1.0001488924026, 1.0001370906830, 1.0001237392426,
        1.0001105070114, 1.0000971555710, 1.0000842809677, 1.0000690221786,
        1.0000549554825, 1.0000417232513, 1.0000283718109, 1.0000145435333,
    };



    /////////////////////////////////////////
    /// Oscillators
    /////////////////////////////////////////
    class TBaseOscillator
    {
    UNCOPYABLE(TBaseOscillator)
        ;

    public:
        TBaseOscillator()
            : Sync(false), PhaseAccumulator(0.0f)
        {
        }

        virtual ~TBaseOscillator()
        {
        }

        virtual void SetFrequency(TFrequency hz)
        {
            Hz = hz;
        }

        virtual void SetPulseWidth(float pw)
        {
        }

        virtual void SetSync(bool sync)
        {
            Sync = sync;
        }
        
        virtual void Process(TSampleBuffer& in, TSampleBuffer& out,
                TSampleBuffer& syncin, TSampleBuffer& syncout)
        {
        }

    protected:    
        double Hz;
        bool Sync;    
        double PhaseAccumulator;
    };


    class TMinBlepPulseOscillator: public TBaseOscillator
    {
    UNCOPYABLE(TMinBlepPulseOscillator)
        ;

    public:
        TMinBlepPulseOscillator();

        /* pw = 0 --> 50% duty cycle
        * pw = 1 --> 100% duty cycle */
        void SetPulseWidth(float pw)
        {
            NextPw = clamp(pw, 0.0f, 0.95f);
        }

        void Process(TSampleBuffer& in, TSampleBuffer& out, TSampleBuffer& syncin,
                TSampleBuffer& syncout);


        double Tick()
        {
            double A = 1.0;
            double outs = 0;
            float pace = Hz / sampleRate;

            
            assert(pace > 0);
            if (pace > 0.99) pace = 0.99;

            double lastpos = PhaseAccumulator;
            PhaseAccumulator += pace;
            if (PhaseAccumulator >= 1) {
                PhaseAccumulator -= 1;
                Pw = NextPw;
            }
            

            const float pw = 0.5 + 0.5 * Pw;
            assert(PhaseAccumulator >= 0);
            assert(PhaseAccumulator <= 1);

            // If Scanpos just went past 0, we need to place a positive
            // edge. If it just went past pw, we need to place a negative
            // edge. The step is constructed from MinBLEP::length samples
            // chosen from MinBLEP::table.

            if ((lastpos < pw && PhaseAccumulator >= pw)
                    || (lastpos < pw && lastpos > PhaseAccumulator)) {
                int offset = (PhaseAccumulator - pw) / pace * MinBLEP::overSampling;
                if (PhaseAccumulator < pw) {
                    offset = ((1 + PhaseAccumulator) - pw) / pace * MinBLEP::overSampling;
                }
                for (int i = 0; i < BufferLen; i++) {
                    Buffer[(BufferPos + i) % BufferLen] -= MinBLEP::table[i
                            * MinBLEP::overSampling + offset];
                }
                Target = 0;
            }
            if (lastpos > PhaseAccumulator) {
                const int offset = PhaseAccumulator / pace * MinBLEP::overSampling;
                for (int i = 0; i < BufferLen; i++) {
                    Buffer[(BufferPos + i) % BufferLen] += MinBLEP::table[i
                            * MinBLEP::overSampling + offset];
                }
                Target = 1;
            }

            outs += A * (Buffer[BufferPos % BufferLen] - pw);
            Buffer[BufferPos % BufferLen] = Target;
            BufferPos++;    
            return outs;            
        }
    
    private:
        static const int BufferLen = MinBLEP::length;
        TSample Buffer[BufferLen];
        int BufferPos;
        int Target;
        float Pw;
        float NextPw;
    };

  
    ///////////////////////////////////
    // MinBLEP Saw
    ///////////////////////////////////

    class TMinBlepSawOscillator: public TBaseOscillator
    {
    public:
        TMinBlepSawOscillator();

        void Process(TSampleBuffer& in, TSampleBuffer& out, TSampleBuffer& syncin,
                TSampleBuffer& syncout);

        double Tick()
        {
            float stepA = 1.0f;
            double out = 0;
            const float A = 1;
            float pace = Hz / sampleRate;

            
            assert(pace > 0);
            if (pace > 0.99) pace = 0.99;

            double lastpos = PhaseAccumulator;
            PhaseAccumulator += pace;
            if (PhaseAccumulator >= 1) {
                PhaseAccumulator -= 1;
            }
            

            /*
            float stepA = 1.0f;
            if (Sync && syncin == 1) {
                stepA = lastpos; // FIXME: This is not precise
                PhaseAccumulator = syncin[sn] * pace; // FIXME: Is this right?
            }
            */

            assert(PhaseAccumulator >= 0);
            assert(PhaseAccumulator <= 1);

            if (lastpos > PhaseAccumulator) {
                // Wrapped around or synced to beginning of wave. Place a step here.
                
                const int offset = PhaseAccumulator / pace * MinBLEP::overSampling;
                for (int i = 0; i < BufferLen; i++) {
                    Buffer[(BufferPos + i) % BufferLen] += stepA
                            * (-1
                                    + MinBLEP::table[i * MinBLEP::overSampling
                                            + offset]);
                }
            }

            // Correct for the fact that the BLEP has an average (integral) that is different from a perfect step
            TSample offsetCorrection = (MinBLEP::integral - MinBLEP::length) * pace;

            out += A
                    * (0.5 + PhaseAccumulator - Buffer[BufferPos % BufferLen]
                            + offsetCorrection);
            Buffer[BufferPos % BufferLen] = 1.0f;
            BufferPos++;
            return out;
        }
        
    private:
        static const int BufferLen = MinBLEP::length;
        TSample Buffer[BufferLen];
        int BufferPos;
    };



    inline TMinBlepPulseOscillator::TMinBlepPulseOscillator()
            : BufferPos(0), Target(0), Pw(0), NextPw(0)
    {
        PhaseAccumulator = 0.99999999;
        SetFrequency(440.0);
        std::fill(Buffer, Buffer + BufferLen, 0);
    }

    inline void TMinBlepPulseOscillator::Process(TSampleBuffer& in, TSampleBuffer& out,
            TSampleBuffer& syncin, TSampleBuffer& syncout)
    {
        const float A = 1.0;
        for (TSample& outs : out) {
            float pace = Hz / sampleRate;
            assert(pace > 0);
            if (pace > 0.99) pace = 0.99;

            double lastpos = PhaseAccumulator;
            PhaseAccumulator += pace;
            if (PhaseAccumulator >= 1) {
                PhaseAccumulator -= 1;
                Pw = NextPw;
            }
            const float pw = 0.5 + 0.5 * Pw;
            assert(PhaseAccumulator >= 0);
            assert(PhaseAccumulator <= 1);

            // If Scanpos just went past 0, we need to place a positive
            // edge. If it just went past pw, we need to place a negative
            // edge. The step is constructed from MinBLEP::length samples
            // chosen from MinBLEP::table.

            if ((lastpos < pw && PhaseAccumulator >= pw)
                    || (lastpos < pw && lastpos > PhaseAccumulator)) {
                int offset = (PhaseAccumulator - pw) / pace * MinBLEP::overSampling;
                if (PhaseAccumulator < pw) {
                    offset = ((1 + PhaseAccumulator) - pw) / pace * MinBLEP::overSampling;
                }
                for (int i = 0; i < BufferLen; i++) {
                    Buffer[(BufferPos + i) % BufferLen] -= MinBLEP::table[i
                            * MinBLEP::overSampling + offset];
                }
                Target = 0;
            }
            if (lastpos > PhaseAccumulator) {
                const int offset = PhaseAccumulator / pace * MinBLEP::overSampling;
                for (int i = 0; i < BufferLen; i++) {
                    Buffer[(BufferPos + i) % BufferLen] += MinBLEP::table[i
                            * MinBLEP::overSampling + offset];
                }
                Target = 1;
            }

            outs += A * (Buffer[BufferPos % BufferLen] - pw);
            Buffer[BufferPos % BufferLen] = Target;
            BufferPos++;
        }
        memset(syncout.data(),0,syncout.size()*sizeof(float));
    }

    
    inline TMinBlepSawOscillator::TMinBlepSawOscillator()
            : BufferPos(0)
    {
        SetFrequency(440.0);
        PhaseAccumulator = 0.5f;
        std::fill(Buffer, Buffer + BufferLen, 1.0f);
    }

    /*
    *  |    |    |
    *  |   /|   /|
    *  |  / |  / |
    *  | /  | /  | /
    *  |/   |/   |/
    *
    *  ^    ^    ^  Place negative minBLEPs here.
    */
    inline void TMinBlepSawOscillator::Process(TSampleBuffer& in, TSampleBuffer& out,
            TSampleBuffer& syncin, TSampleBuffer& syncout)
    {
        const float A = 1;
        for (size_t sn = 0; sn < out.size(); sn++) {
            float pace = Hz / sampleRate;
            assert(pace > 0);
            if (pace > 0.99) pace = 0.99;

            double lastpos = PhaseAccumulator;
            PhaseAccumulator += pace;
            if (PhaseAccumulator >= 1) {
                PhaseAccumulator -= 1;
            }

            float stepA = 1.0f;
            if (Sync && syncin[sn] > 0) {
                stepA = lastpos; // FIXME: This is not precise
                PhaseAccumulator = syncin[sn] * pace; // FIXME: Is this right?
            }

            assert(PhaseAccumulator >= 0);
            assert(PhaseAccumulator <= 1);

            if (lastpos > PhaseAccumulator) {
                // Wrapped around or synced to beginning of wave. Place a step here.
                syncout[sn] = PhaseAccumulator / pace + 0.0000001;
                const int offset = PhaseAccumulator / pace * MinBLEP::overSampling;
                for (int i = 0; i < BufferLen; i++) {
                    Buffer[(BufferPos + i) % BufferLen] += stepA
                            * (-1
                                    + MinBLEP::table[i * MinBLEP::overSampling
                                            + offset]);
                }
            }
            else {
                syncout[sn] = 0;
            }

            // Correct for the fact that the BLEP has an average (integral) that is different from a perfect step
            TSample offsetCorrection = (MinBLEP::integral - MinBLEP::length) * pace;

            out[sn] += A
                    * (0.5 + PhaseAccumulator - Buffer[BufferPos % BufferLen]
                            + offsetCorrection);
            Buffer[BufferPos % BufferLen] = 1.0f;
            BufferPos++;
        }
    }
}