/*
  ==============================================================================
    FilterBank.h
    Created: 12 Sep 2015 2:56:38pm
    Author:  Tony Ducks
  ==============================================================================
*/

#pragma once


class BicuadFilter{
public:
    BicuadFilter();
    ~BicuadFilter();
    
    void makeInactive();
    void setCoeficientes (const DspFloatType* _coeff,const DspFloatType* G);
    void reset();
    void processSamples (DspFloatType* samples, int numSamples);

protected:
    
    DspFloatType      coeff[5];
    DspFloatType       u1, u2;
    bool        active;
};

//==============================================================================
class BandFilter{
public:
    BandFilter(int numBqs);
    ~BandFilter();
    void processSamples (DspFloatType* samples, int numSamples);
    void reset();
    
    std::vector<BicuadFilter*>        bicuadFiltersArray;        
};

//==============================================================================
class FilterBank{
public:
    FilterBank(int bandas);
    ~FilterBank();
    void setCoeficientes();
    void processSamples(DspFloatType* const input, AudioSampleBuffer* outputs, int numSamples);
    void processSamples(DspFloatType* const input,OwnedArray<AudioSampleBuffer>* outputs,int numSamples);
    void processSamples(DspFloatType* const input,DspFloatType* const output,int numSamples);
    
protected:
    std::vector<BandFilter*>          bandFiltersArray;
    int                             bandFilterOrder;
    int                             numeroBandas;
    
};



/*
  ==============================================================================
    FilterBank.cpp
    Created: 12 Sep 2015 2:56:38pm
    Author:  Tony Ducks
  ==============================================================================
*/

const DspFloatType SOS8[50][6]={
    {1,	0,	-1,	1,	-1.9987785419781900,	0.9988117258019110},
    {1,	0,	-1,	1,	-1.9993777884581000,	0.9993866278646940},
    {1,	0,	-1,	1,	-1.9971209427486900,	0.9971471912629550},
    {1,	0,	-1,	1,	-1.9981283386990000,	0.9981394973411570},
    {1,	0,	-1,	1,	-1.9970705594060100,	0.9970876688734220},
    {1,	0,	-1,	1,	-1.9974984404356400,	0.9976304706427330},
    {1,	0,	-1,	1,	-1.9987413356052400,	0.9987765148787840},
    {1,	0,	-1,	1,	-1.9942115653344000,	0.9943159154709810},
    {1,	0,	-1,	1,	-1.9962467971960800,	0.9962911792808700},
    {1,	0,	-1,	1,	-1.9941294437408600,	0.9941974596068910},
    {1,	0,	-1,	1,	-1.9947529222933400,	0.9952779099207740},
    {1,	0,	-1,	1,	-1.9974203055659500,	0.9975602723081400},
    {1,	0,	-1,	1,	-1.9882767015152000,	0.9886909495382260},
    {1,	0,	-1,	1,	-1.9924370967165000,	0.9926134601020490},
    {1,	0,	-1,	1,	-1.9881856999664500,	0.9884556963352590},
    {1,	0,	-1,	1,	-1.9885166329064000,	0.9906014793303250},
    {1,	0,	-1,	1,	-1.9945811687237500,	0.9951376932542060},
    {1,	0,	-1,	1,	-1.9759231162258900,	0.9775629162306730},
    {1,	0,	-1,	1,	-1.9846155078497700,	0.9853150300291520},
    {1,	0,	-1,	1,	-1.9760282949767200,	0.9770969934941140},
    {1,	0,	-1,	1,	-1.9730865461937500,	0.9813437473671320},
    {1,	0,	-1,	1,	-1.9881093386083600,	0.9903192484068190},
    {1,	0,	-1,	1,	-1.9492801783056100,	0.9557344169724620},
    {1,	0,	-1,	1,	-1.9681407430535500,	0.9709050138662140},
    {1,	0,	-1,	1,	-1.9506053344215500,	0.9548113738628170},
    {1,	0,	-1,	1,	-1.9306827437031400,	0.9631890368913960},
    {1,	0,	-1,	1,	-1.9720058599023600,	0.9807567354123720},
    {1,	0,	-1,	1,	-1.8885318974812400,	0.9136446112809490},
    {1,	0,	-1,	1,	-1.9318797491090600,	0.9427215699124380},
    {1,	0,	-1,	1,	-1.8954079912552000,	0.9117751031393520},
    {1,	0,	-1,	1,	-1.8023071503797200,	0.9284162599148670},
    {1,	0,	-1,	1,	-1.9273789280674200,	0.9618100133290710},
    {1,	0,	-1,	1,	-1.7398199745301200,	0.8352580392918490},
    {1,	0,	-1,	1,	-1.8465966688718200,	0.8884670574336160},
    {1,	0,	-1,	1,	-1.7687708335765300,	0.8310442555528910},
    {1,	0,	-1,	1,	-1.3955531779493600,	0.8661403638647370},
    {1,	0,	-1,	1,	-1.7906838470206800,	0.9239734168407860},
    {1,	0,	-1,	1,	-1.6297666243394900,	0.7861277319901490},
    {1,	0,	-1,	1,	-1.3541257698437400,	0.6994784223963890},
    {1,	0,	-1,	1,	-1.4603554506117600,	0.6867963501848830},
    {1,	0,	-1,	1,	-1.3521878785423800,	0.8435403365885230},
    {1,	0,	-1,	1,	-0.2106576849949040,	0.7793891539872490},
    {1,	0,	-1,	1,	-1.0559839509843300,	0.5924242965235340},
    {1,	0,	-1,	1,	-0.3775767119355060,	0.5026597333620270},
    {1,	0,	-1,	1,	-0.6989267851773300,	0.4454818614031410},
    {1,	0,	-1,	1,	-0.1416568013285740,	0.5913639980916540},
    {1,	0,	-1,	1,	 1.8530515046862500,	0.8962482763871150},
    {1,	0,	-1,	1,	 1.6583693624895500,	0.7060764017292220},
    {1,	0,	-1,	1,	 0.0167934472295311,	0.1536898897912410},
    {1,	0,	-1,	1,	 0.8330452984098530,	0.0545720981915791}};
const DspFloatType G8[50]={
    0.0014576308112768000,
    0.0014576308112768000,
    0.0014565701059445200,
    0.0014565701059445200,
    0.0014561655632890900,
    0.0029070870276006100,
    0.0029070870276006100,
    0.0029028744365330300,
    0.0029028744365330300,
    0.0029012701965546700,
    0.0057951779898874600,
    0.0057951779898874600,
    0.0057784886447897700,
    0.0057784886447897700,
    0.0057721518323703600,
    0.0115421438898502000,
    0.0115421438898502000,
    0.0114763419562426000,
    0.0114763419562426000,
    0.0114515032529433000,
    0.0229471898007297000,
    0.0229471898007297000,
    0.0226902147212009000,
    0.0226902147212009000,
    0.0225943130685917000,
    0.0454567717030985000,
    0.0454567717030985000,
    0.0444720396725626000,
    0.0444720396725626000,
    0.0441124484303241000,
    0.0893899760313232000,
    0.0893899760313232000,
    0.0857540308589821000,
    0.0857540308589821000,
    0.0844778722235543000,
    0.1732048620122510000,
    0.1732048620122510000,
    0.1607080806469280000,
    0.1607080806469280000,
    0.1566018249075580000,
    0.3260579390159850000,
    0.3260579390159850000,
    0.2885206556669380000,
    0.2885206556669380000,
    0.2772590692984290000,
    0.5838478415853340000,
    0.5838478415853340000,
    0.4969627438920420000,
    0.4969627438920420000,
    0.4727139509042110000};

const DspFloatType SOS3[150][6]={
    {1,	0,	-1,	1,	-1.9997264944912300,	0.9997399539975210},
    {1,	0,	-1,	1,	-1.9997824399135800,	0.9997911217084900},
    {1,	0,	-1,	1,	-1.9993322079439500,	0.9993445919497050},
    {1,	0,	-1,	1,	-1.9994185486701100,	0.9994279810609780},
    {1,	0,	-1,	1,	-1.9992306550994800,	0.9992414622369400},
    {1,	0,	-1,	1,	-1.9996513442483800,	0.9996726738958890},
    {1,	0,	-1,	1,	-1.9997233230590000,	0.9997370836719440},
    {1,	0,	-1,	1,	-1.9991554461900100,	0.9991750711087530},
    {1,	0,	-1,	1,	-1.9992650739838100,	0.9992800228451220},
    {1,	0,	-1,	1,	-1.9990281543556000,	0.9990452808230110},
    {1,	0,	-1,	1,	-1.9995541035200200,	0.9995879072782290},
    {1,	0,	-1,	1,	-1.9996471923238000,	0.9996690000672450},
    {1,	0,	-1,	1,	-1.9989304139953000,	0.9989615140053650},
    {1,	0,	-1,	1,	-1.9990699389745300,	0.9990936284394850},
    {1,	0,	-1,	1,	-1.9987710071648400,	0.9987981470267080},
    {1,	0,	-1,	1,	-1.9994276487828600,	0.9994812217681580},
    {1,	0,	-1,	1,	-1.9995487437037500,	0.9995833052546770},
    {1,	0,	-1,	1,	-1.9986434865101700,	0.9986927705191140},
    {1,	0,	-1,	1,	-1.9988215141905200,	0.9988590551552440},
    {1,	0,	-1,	1,	-1.9984441517158300,	0.9984871590613170},
    {1,	0,	-1,	1,	-1.9992620254428700,	0.9993469283259860},
    {1,	0,	-1,	1,	-1.9994206576285700,	0.9994754316320690},
    {1,	0,	-1,	1,	-1.9982764506100100,	0.9983545488149340},
    {1,	0,	-1,	1,	-1.9985043263439600,	0.9985638161100480},
    {1,	0,	-1,	1,	-1.9980276342086700,	0.9980957837276860},
    {1,	0,	-1,	1,	-1.9990434138150700,	0.9991779621150800},
    {1,	0,	-1,	1,	-1.9992528835767300,	0.9993396897644380},
    {1,	0,	-1,	1,	-1.9978053375625200,	0.9979290869397640},
    {1,	0,	-1,	1,	-1.9980981297968800,	0.9981923980783720},
    {1,	0,	-1,	1,	-1.9974954996550500,	0.9976034825527070},
    {1,	0,	-1,	1,	-1.9987519625062900,	0.9989651840468540},
    {1,	0,	-1,	1,	-1.9990311954737700,	0.9991687597993980},
    {1,	0,	-1,	1,	-1.9971973940068200,	0.9973934701717560},
    {1,	0,	-1,	1,	-1.9975754425977600,	0.9977248104704290},
    {1,	0,	-1,	1,	-1.9968126944944700,	0.9969837811253700},
    {1,	0,	-1,	1,	-1.9983595499522400,	0.9986974348884340},
    {1,	0,	-1,	1,	-1.9987356455830100,	0.9989536464177300},
    {1,	0,	-1,	1,	-1.9964090614341400,	0.9967197139673730},
    {1,	0,	-1,	1,	-1.9968999010546000,	0.9971365627919800},
    {1,	0,	-1,	1,	-1.9959332680074000,	0.9962043148199830},
    {1,	0,	-1,	1,	-1.9978250583613600,	0.9983604693748050},
    {1,	0,	-1,	1,	-1.9983374421832400,	0.9986828999872260},
    {1,	0,	-1,	1,	-1.9953800335316400,	0.9958721673913700},
    {1,	0,	-1,	1,	-1.9960215555159400,	0.9963964959167210},
    {1,	0,	-1,	1,	-1.9947945348926900,	0.9952238983268560},
    {1,	0,	-1,	1,	-1.9970880432186700,	0.9979364089240250},
    {1,	0,	-1,	1,	-1.9977947267912300,	0.9983421364579700},
    {1,	0,	-1,	1,	-1.9940266186866800,	0.9948061621124250},
    {1,	0,	-1,	1,	-1.9948715887152500,	0.9954655400679240},
    {1,	0,	-1,	1,	-1.9933108853925300,	0.9939909450277590},
    {1,	0,	-1,	1,	-1.9960586732358200,	0.9974028263529810},
    {1,	0,	-1,	1,	-1.9970459175237200,	0.9979132927039260},
    {1,	0,	-1,	1,	-1.9922311734352800,	0.9934657894300700},
    {1,	0,	-1,	1,	-1.9933539756531900,	0.9942947449902860},
    {1,	0,	-1,	1,	-1.9913639615888600,	0.9924409102486520},
    {1,	0,	-1,	1,	-1.9946020441780000,	0.9967315279947200},
    {1,	0,	-1,	1,	-1.9959993752302000,	0.9973736416296750},
    {1,	0,	-1,	1,	-1.9898259972931600,	0.9917809634165870},
    {1,	0,	-1,	1,	-1.9913328401345700,	0.9928226910162430},
    {1,	0,	-1,	1,	-1.9887878364708900,	0.9904929302366080},
    {1,	0,	-1,	1,	-1.9925138582198900,	0.9958870994952390},
    {1,	0,	-1,	1,	-1.9945174158402000,	0.9966945954395660},
    {1,	0,	-1,	1,	-1.9865691112855100,	0.9896639544505980},
    {1,	0,	-1,	1,	-1.9886134945510900,	0.9909723923291470},
    {1,	0,	-1,	1,	-1.9853469886923500,	0.9880458497746440},
    {1,	0,	-1,	1,	-1.9894828452303200,	0.9948253369903920},
    {1,	0,	-1,	1,	-1.9923915887190000,	0.9958403579974620},
    {1,	0,	-1,	1,	-1.9821080029264200,	0.9870057205354970},
    {1,	0,	-1,	1,	-1.9849140815901400,	0.9886479109418950},
    {1,	0,	-1,	1,	-1.9807037257165100,	0.9849739899835830},
    {1,	0,	-1,	1,	-1.9850310074991900,	0.9934904349600730},
    {1,	0,	-1,	1,	-1.9893036012923900,	0.9947656573421950},
    {1,	0,	-1,	1,	-1.9759218049700500,	0.9836693381416900},
    {1,	0,	-1,	1,	-1.9798205783015900,	0.9857285550238160},
    {1,	0,	-1,	1,	-1.9743662788183600,	0.9811197044242660},
    {1,	0,	-1,	1,	-1.9784227150294400,	0.9918132000942400},
    {1,	0,	-1,	1,	-1.9847653463844800,	0.9934139718027460},
    {1,	0,	-1,	1,	-1.9672374999662200,	0.9794861104950950},
    {1,	0,	-1,	1,	-1.9727211987186100,	0.9820648281823210},
    {1,	0,	-1,	1,	-1.9656147605555600,	0.9762887644066490},
    {1,	0,	-1,	1,	-1.9685207904712400,	0.9897069776091510},
    {1,	0,	-1,	1,	-1.9780243383071600,	0.9917140220321750},
    {1,	0,	-1,	1,	-1.9548963572830400,	0.9742464066660690},
    {1,	0,	-1,	1,	-1.9627021657080400,	0.9774699205780660},
    {1,	0,	-1,	1,	-1.9533829427713900,	0.9702398940044390},
    {1,	0,	-1,	1,	-1.9535656439873000,	0.9870642408558780},
    {1,	0,	-1,	1,	-1.9679173316671400,	0.9895762443227140},
    {1,	0,	-1,	1,	-1.9371547547510900,	0.9676924942283710},
    {1,	0,	-1,	1,	-1.9483912412110300,	0.9717119672123600},
    {1,	0,	-1,	1,	-1.9360833488597500,	0.9626762153836830},
    {1,	0,	-1,	1,	-1.9308363160230500,	0.9837525618688450},
    {1,	0,	-1,	1,	-1.9526436580044000,	0.9868881247551670},
    {1,	0,	-1,	1,	-1.9113831755942400,	0.9595103618642820},
    {1,	0,	-1,	1,	-1.9277196120526700,	0.9645043138924040},
    {1,	0,	-1,	1,	-1.9113435698926800,	0.9532351255986630},
    {1,	0,	-1,	1,	-1.8961352884546200,	0.9796092518905440},
    {1,	0,	-1,	1,	-1.9294167319006900,	0.9835073068861270},
    {1,	0,	-1,	1,	-1.8736152637298300,	0.9493188737767600},
    {1,	0,	-1,	1,	-1.8975618186314700,	0.9554915239467910},
    {1,	0,	-1,	1,	-1.8756115225313300,	0.9414742875553860},
    {1,	0,	-1,	1,	-1.8430300562975800,	0.9744383861678370},
    {1,	0,	-1,	1,	-1.8939370315223600,	0.9792537073778600},
    {1,	0,	-1,	1,	-1.8179001623292700,	0.9366649302249880},
    {1,	0,	-1,	1,	-1.8532077847015100,	0.9442359614502860},
    {1,	0,	-1,	1,	-1.8235884055205000,	0.9268620915649870},
    {1,	0,	-1,	1,	-1.7617731301756200,	0.9680081598807500},
    {1,	0,	-1,	1,	-1.8396129210567200,	0.9738969672252340},
    {1,	0,	-1,	1,	-1.7353986542672400,	0.9210187640258240},
    {1,	0,	-1,	1,	-1.7876048065167200,	0.9301969445931770},
    {1,	0,	-1,	1,	-1.7474326665002400,	0.9087640503341040},
    {1,	0,	-1,	1,	-1.6378821524558200,	0.9600548808912040},
    {1,	0,	-1,	1,	-1.7564566189576100,	0.9671385006977560},
    {1,	0,	-1,	1,	-1.6132313185738100,	0.9017816778638660},
    {1,	0,	-1,	1,	-1.6903357722154500,	0.9127048675092270},
    {1,	0,	-1,	1,	-1.6357308332933300,	0.8864338963794800},
    {1,	0,	-1,	1,	-1.4505574092161900,	0.9502996957488870},
    {1,	0,	-1,	1,	-1.6296413227227400,	0.9585818924616550},
    {1,	0,	-1,	1,	-1.4332524697156600,	0.8783136601342260},
    {1,	0,	-1,	1,	-1.5463905058149000,	0.8909215601404510},
    {1,	0,	-1,	1,	-1.4723561100553800,	0.8590078158514100},
    {1,	0,	-1,	1,	-1.1716880606896000,	0.9384948426615820},
    {1,	0,	-1,	1,	-1.4379311542185500,	0.9476794852645180},
    {1,	0,	-1,	1,	-1.1713943376476600,	0.8500033134374660},
    {1,	0,	-1,	1,	-1.3350816679284300,	0.8637721601908350},
    {1,	0,	-1,	1,	-1.2357073042003400,	0.8255046423383980},
    {1,	0,	-1,	1,	-1.1528433809320900,	0.9336242140612560},
    {1,	0,	-1,	1,	-0.7675924791758500,	0.9245395871745480},
    {1,	0,	-1,	1,	-1.0302082376248300,	0.8298094276788910},
    {1,	0,	-1,	1,	-0.7993068167704220,	0.8164313084981850},
    {1,	0,	-1,	1,	-0.8996971074910270,	0.7848348548842910},
    {1,	0,	-1,	1,	-0.2085471503858270,	0.9087749890295920},
    {1,	0,	-1,	1,	-0.7410098091141660,	0.9150938783562730},
    {1,	0,	-1,	1,	-0.2921664071668170,	0.7777657845962450},
    {1,	0,	-1,	1,	-0.6042836817068970,	0.7868883393970710},
    {1,	0,	-1,	1,	-0.4396894520434820,	0.7358156101023690},
    {1,	0,	-1,	1,	-0.1757318528862690,	0.8895112684725800},
    {1,	0,	-1,	1,	0.5040866494922680,     0.8928487999193670},
    {1,	0,	-1,	1,	-0.0431374917282857,	0.7312002991625050},
    {1,	0,	-1,	1,	0.3501937450079630,	0.7359260183375640},
    {1,	0,	-1,	1,	0.1502213346459930,	0.6771918595952250},
    {1,	0,	-1,	1,	0.5292949936386940,	0.8500438959905800},
    {1,	0,	-1,	1,	1.2807500871736500,	0.8832100518796220},
    {1,	0,	-1,	1,	1.0612248808027100,	0.6997364565326180},
    {1,	0,	-1,	1,	0.6160189599204330,	0.6530879670776760},
    {1,	0,	-1,	1,	0.8187863376835580,	0.6076433299006480},
    {1,	0,	-1,	1,	1.2268740800002400,	0.7609702239098310},
    {1,	0,	-1,	1,	1.8780124258609500,	0.9223385936167950},
    {1,	0,	-1,	1,	1.7018415366604400,	0.7588252293283610},
    {1,	0,	-1,	1,	1.1543991866724800,	0.4891260849370190},
    {1,	0,	-1,	1,	1.3925045863861600,	0.5257563926726760}};
const DspFloatType G3[150]={0.0003793682772628410,
    0.0003793682772628410,
    0.0003792963460218810,
    0.0003792963460218810,
    0.0003792688815297980,
    0.0004775170470058880,
    0.0004775170470058880,
    0.0004774030933796070,
    0.0004774030933796070,
    0.0004773595884943480,
    0.0006011760147351280,
    0.0006011760147351280,
    0.0006009954234409290,
    0.0006009954234409290,
    0.0006009264866462730,
    0.0007568158411280170,
    0.0007568158411280170,
    0.0007565296854471970,
    0.0007565296854471970,
    0.0007564204693416140,
    0.0009527345403472650,
    0.0009527345403472650,
    0.0009522811464521650,
    0.0009522811464521650,
    0.0009521081361569660,
    0.0011992508957153700,
    0.0011992508957153700,
    0.0011985327069807300,
    0.0011985327069807300,
    0.0011982587236464100,
    0.0015096810882681500,
    0.0015096810882681500,
    0.0015085433400404700,
    0.0015085433400404700,
    0.0015081094373151000,
    0.0019003315414671900,
    0.0019003315414671900,
    0.0018985295411413700,
    0.0018985295411413700,
    0.0018978425900085400,
    0.0023919916887468800,
    0.0023919916887468800,
    0.0023891381131272800,
    0.0023891381131272800,
    0.0023880508365718100,
    0.0030107657517060500,
    0.0030107657517060500,
    0.0030062478216210100,
    0.0030062478216210100,
    0.0030045274861206700,
    0.0037894167760709800,
    0.0037894167760709800,
    0.0037822656840270800,
    0.0037822656840270800,
    0.0037795448756739300,
    0.0047691507935983900,
    0.0047691507935983900,
    0.0047578356675874900,
    0.0047578356675874900,
    0.0047535348816962100,
    0.0060017653759984400,
    0.0060017653759984400,
    0.0059838688462349400,
    0.0059838688462349400,
    0.0059770751126778700,
    0.0075520164467041600,
    0.0075520164467041600,
    0.0075237270086581500,
    0.0075237270086581500,
    0.0075130050082082600,
    0.0095017420193490100,
    0.0095017420193490100,
    0.0094570521326987100,
    0.0094570521326987100,
    0.0094401477878672000,
    0.0119527691940424000,
    0.0119527691940424000,
    0.0118822326470415000,
    0.0118822326470415000,
    0.0118556177966753000,
    0.0150331003671568000,
    0.0150331003671568000,
    0.0149218862119261000,
    0.0149218862119261000,
    0.0148800529977807000,
    0.0189026267276066000,
    0.0189026267276066000,
    0.0187275084302824000,
    0.0187275084302824000,
    0.0186618923081584000,
    0.0237603593413056000,
    0.0237603593413056000,
    0.0234850853954573000,
    0.0234850853954573000,
    0.0233824372006684000,
    0.0298547246992513000,
    0.0298547246992513000,
    0.0294229158035501000,
    0.0294229158035501000,
    0.0292628562223072000,
    0.0374930933733565000,
    0.0374930933733565000,
    0.0368175255469993000,
    0.0368175255469993000,
    0.0365689542175064000,
    0.0470555190585004000,
    0.0470555190585004000,
    0.0460020775039073000,
    0.0460020775039073000,
    0.0456179748329483000,
    0.0590088392353889000,
    0.0590088392353889000,
    0.0573729411630312000,
    0.0573729411630312000,
    0.0567830518102601000,
    0.0739225401997950000,
    0.0739225401997950000,
    0.0713952241430816000,
    0.0713952241430816000,
    0.0704960920742949000,
    0.0924851387431417000,
    0.0924851387431417000,
    0.0886056923573992000,
    0.0886056923573992000,
    0.0872476788308011000,
    0.1155187251210530000,
    0.1155187251210530000,
    0.1096111754373940000,
    0.1096111754373940000,
    0.1075825725578550000,
    0.1439902349514900000,
    0.1439902349514900000,
    0.1350829474678870000,
    0.1350829474678870000,
    0.1320921949488150000,
    0.1790124994295030000,
    0.1790124994295030000,
    0.1657454615848860000,
    0.1657454615848860000,
    0.1614040702023880000,
    0.2218334279138090000,
    0.2218334279138090000,
    0.2023675996295870000,
    0.2023675996295870000,
    0.1961783350496760000,
    0.2738029979672370000,
    0.2738029979672370000,
    0.2457644069853140000,
    0.2457644069853140000,
    0.2371218036636620000};

//==============================================================================
BicuadFilter::BicuadFilter(): u1(0), u2(0), active(false){
}

BicuadFilter::~BicuadFilter(){
}

//==============================================================================
void BicuadFilter::makeInactive(){
    active = false;
}

//==============================================================================
void BicuadFilter::setCoeficientes (const DspFloatType* _coeff,const DspFloatType* G){
    const DspFloatType aux1=*G/_coeff[3];
    const DspFloatType aux2=1.0/_coeff[3];
    
    coeff[0]=_coeff[0]*aux1;
    coeff[1]=_coeff[1]*aux1;
    coeff[2]=_coeff[2]*aux1;
    coeff[3]=_coeff[4]*aux2;
    coeff[4]=_coeff[5]*aux2;
    
    active = true;
}

//==============================================================================
void BicuadFilter::reset(){
    u1 = u2 = 0;
}

//==============================================================================
void BicuadFilter::processSamples (DspFloatType* const samples, const int numSamples){    
    if (active){
        const DspFloatType b0 = coeff[0];
        const DspFloatType b1 = coeff[1];
        const DspFloatType b2 = coeff[2];
        const DspFloatType a1 = coeff[3];
        const DspFloatType a2 = coeff[4];
        DspFloatType u_1 = u1, u_2 = u2;
        
        for (int i = 0; i < numSamples; i++){
            const DspFloatType in = samples[i];
            const DspFloatType out = b0*in + u_1;
            samples[i] = out;
            
            u_1 = b1*in - a1*out + u_2;
            u_2 = b2*in - a2*out;
        }
        u1 = u_1;
        u2 = u_2;
    }
}

/*
 ==============================================================================
 BandFilter Class
 ==============================================================================
*/
BandFilter::BandFilter(int bandFilterOrder){
    for(int i=0;i<bandFilterOrder/2;i++){
        bicuadFiltersArray.add(new BicuadFilter());
    }
}

//==============================================================================
BandFilter::~BandFilter(){
}

//==============================================================================
void BandFilter::reset(){
    for(int i=0;i<bicuadFiltersArray.size();i++){
        bicuadFiltersArray[i]->reset();
    }
}

//==============================================================================
void BandFilter::processSamples (DspFloatType* const samples, const int numSamples){
    for(int i=0;i<bicuadFiltersArray.size();i++){
        bicuadFiltersArray[i]->processSamples(samples, numSamples);
    }
}

/*
 ==============================================================================
 FilterBank Class
 ==============================================================================
*/
FilterBank::FilterBank(int bandas){
    numeroBandas = bandas;
    bandFilterOrder = 10;
    for(int i=0;i<numeroBandas;i++){
        bandFiltersArray.add(new BandFilter(bandFilterOrder));
    }
}

//==============================================================================
FilterBank::~FilterBank(){
}

//==============================================================================
void FilterBank::processSamples(DspFloatType* const input,AudioSampleBuffer* outputs,int numSamples){
    for(int i=0; i<bandFiltersArray.size(); i++){
        outputs->copyFrom(i, 0, input, numSamples);
        bandFiltersArray[i]->processSamples(outputs->getWritePointer(i), numSamples);
    }
}

//==============================================================================
void FilterBank::processSamples(DspFloatType* const input,OwnedArray<AudioSampleBuffer>* outputs,int numSamples){
    for(int i=0; i<bandFiltersArray.size(); i++){
        memcpy(outputs->getUnchecked(i)->getWritePointer(0), input, numSamples*sizeof(DspFloatType));
        bandFiltersArray[i]->processSamples(outputs->getUnchecked(i)->getWritePointer(0), numSamples);
    }
}

//==============================================================================
void FilterBank::setCoeficientes(){
    const DspFloatType* G;
    
    if (numeroBandas==10) {
        G=G8;
    }else if (numeroBandas==30){
        G=G3;
    }
    
    
    for(int i=0; i<bandFiltersArray.size(); i++){
        for(int j=0; j<bandFilterOrder/2; j++){
            const DspFloatType* coeff;
            if (numeroBandas==10) {
                coeff= SOS8[5*i+j];
            }else if (numeroBandas==30){
                coeff= SOS3[5*i+j];
            }
            bandFiltersArray[i]->bicuadFiltersArray[j]->setCoeficientes(coeff, G);
            G++;
        }
    }
}